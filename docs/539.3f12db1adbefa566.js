"use strict";(self.webpackChunkpublic_square=self.webpackChunkpublic_square||[]).push([[539],{8539:(ki,z,p)=>{p.r(z),p.d(z,{UsersModule:()=>Zi});var g=p(6895),_=p(9197),H=p(5861),m=p(5938),f=p(4006),u=p(727),t=p(4650),x=p(8503),k=p(9935),U=p(6709),C=p(4859),v=p(1572);function K(o,a){if(1&o&&(t.TgZ(0,"p",8),t._uU(1),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.hij(" ",e.data.username," ")}}function $(o,a){if(1&o&&(t.TgZ(0,"p",9),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.xp6(1),t.hij(" ",e," ")}}function X(o,a){if(1&o&&(t.TgZ(0,"div")(1,"p"),t._uU(2,"Do you want to follow this user?"),t.qZA(),t.YNc(3,K,2,1,"p",4),t.YNc(4,$,2,1,"p",5),t.TgZ(5,"p",6)(6,"mat-checkbox",7),t._uU(7," Follow for FREE (Dispatch method) "),t.qZA()()()),2&o){const e=t.oxw(2);t.xp6(3),t.Q6J("ngIf",e.data.username),t.xp6(1),t.Q6J("ngForOf",e.data.wallets),t.xp6(2),t.Q6J("formControl",e.useDispatch)}}function W(o,a){1&o&&(t.TgZ(0,"div")(1,"p")(2,"span"),t._uU(3,"Sending tx ..."),t.qZA(),t._UZ(4,"mat-spinner",10),t.qZA()()),2&o&&(t.xp6(4),t.Q6J("diameter",20))}function tt(o,a){if(1&o&&(t.TgZ(0,"div")(1,"p"),t._uU(2),t.qZA(),t.TgZ(3,"p"),t._uU(4," Your transaction is gonna be mined in the next minutes. You can take a coffee now! \u2615 "),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(2),t.hij("Tx ",e.followTxId," created succesfully!")}}function et(o,a){if(1&o&&(t.TgZ(0,"mat-dialog-content",2),t.YNc(1,X,8,3,"div",3),t.YNc(2,W,5,1,"div",3),t.YNc(3,tt,5,1,"div",3),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.loadingFollow&&!e.followTxId),t.xp6(1),t.Q6J("ngIf",e.loadingFollow),t.xp6(1),t.Q6J("ngIf",!e.loadingFollow&&e.followTxId)}}function it(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.submit())}),t.TgZ(1,"span"),t._uU(2,"Yes, I want to follow this user! "),t.qZA()()}if(2&o){const e=t.oxw(2);t.Q6J("disabled",e.loadingFollow)}}function nt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-dialog-actions",11)(1,"button",12),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.close(!1))}),t._uU(2,"Close"),t.qZA(),t._UZ(3,"div",13),t.YNc(4,it,3,1,"button",14),t.qZA()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("disabled",e.loadingFollow),t.xp6(3),t.Q6J("ngIf",!e.followTxId)}}let ot=(()=>{class o{constructor(e,i,n,s){this._dialogRef=e,this.data=i,this._utils=n,this._follow=s,this.useDispatch=new f.p4(!1),this.loadingFollow=!1,this.followSubscription=u.w0.EMPTY,this.followTxId=""}ngOnInit(){}close(e=!1){this._dialogRef.close(e)}submit(){const e=!this.useDispatch.value;this.loadingFollow=!0,this.followSubscription=this._follow.follow(this.data.wallets,e).subscribe({next:i=>{this.loadingFollow=!1,this.followTxId=i.id},error:i=>{this.loadingFollow=!1,console.error("Error!",i),this._utils.message("Error!","error")}})}ngOnDestroy(){this.followSubscription.unsubscribe()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(m.so),t.Y36(m.WI),t.Y36(x.F),t.Y36(k.R))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-follow-dialog"]],decls:2,vars:2,consts:[["class","content border-right-special",4,"ngIf"],["align","start",4,"ngIf"],[1,"content","border-right-special"],[4,"ngIf"],["class","text-center",4,"ngIf"],["class","text-center wallets",4,"ngFor","ngForOf"],[1,"text-right"],[1,"dispatch-chk",3,"formControl"],[1,"text-center"],[1,"text-center","wallets"],["color","accent",3,"diameter"],["align","start"],["mat-button","","cdkFocusInitial","",3,"disabled","click"],[1,"spacer"],["mat-flat-button","","color","accent",3,"disabled","click",4,"ngIf"],["mat-flat-button","","color","accent",3,"disabled","click"]],template:function(e,i){1&e&&(t.YNc(0,et,4,3,"mat-dialog-content",0),t.YNc(1,nt,5,2,"mat-dialog-actions",1)),2&e&&(t.Q6J("ngIf",i.data.wallets),t.xp6(1),t.Q6J("ngIf",i.data.wallets))},dependencies:[g.sg,g.O5,U.oG,f.JJ,f.oH,C.lW,v.Ou,m.xY,m.H8],styles:[".content[_ngcontent-%COMP%]{padding:10px;min-height:100px;max-width:680px;min-width:200px}.content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:6px}.title-text[_ngcontent-%COMP%]{font-weight:700}.mat-dialog-container[_ngcontent-%COMP%]{padding:0}@media (min-width: 420px){.content[_ngcontent-%COMP%]{min-width:400px}}@media (min-width: 820px){.content[_ngcontent-%COMP%]{min-width:680px}}.wallets[_ngcontent-%COMP%], .dispatch-chk[_ngcontent-%COMP%]{font-size:12px}.mat-spinner[_ngcontent-%COMP%]{display:inline;margin-left:12px}"]}),o})();var w=p(3900),b=p(2753),F=p(608),R=p(3162),st=p(7314);function at(o,a){1&o&&t._UZ(0,"mat-progress-bar",8)}function rt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",9)(1,"p")(2,"strong"),t._uU(3,"From: "),t.qZA(),t._uU(4),t._UZ(5,"br"),t.TgZ(6,"strong"),t._uU(7,"Balance: "),t.qZA(),t._uU(8),t.qZA(),t.TgZ(9,"p")(10,"strong"),t._uU(11,"To: "),t.qZA(),t._uU(12),t._UZ(13,"br"),t.qZA(),t.TgZ(14,"p")(15,"strong"),t._uU(16,"Choose amount: "),t.qZA()(),t.TgZ(17,"div",10)(18,"mat-slider",11),t.NdJ("ngModelChange",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.amount=n)}),t.qZA()(),t.TgZ(19,"div"),t._uU(20),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(4),t.hij("",e.data.mainAddress," "),t.xp6(4),t.hij("",e.balance," "),t.xp6(4),t.hij("",e.data.to," "),t.xp6(6),t.Q6J("ngModel",e.amount)("disabled",e.loadingBalance)("max",e.maxAmount),t.xp6(2),t.hij(" ",e.amount," AR ")}}function lt(o,a){1&o&&(t.TgZ(0,"div"),t._uU(1,"\u{1f64f} Please login first \u{1f47e}"),t.qZA())}function ct(o,a){1&o&&(t.TgZ(0,"h1"),t._uU(1,"\u{1f680} Transaction in progress, hold on!"),t.qZA())}function pt(o,a){1&o&&(t.TgZ(0,"h2"),t._uU(1,"\u{1f973} Donation sent! Thank you very much for your support! \u{1f64f}\u{1f64c}"),t.qZA())}function dt(o,a){1&o&&(t.TgZ(0,"h2"),t._uU(1,"You can close this window now."),t.qZA())}function gt(o,a){if(1&o&&(t.TgZ(0,"div"),t.YNc(1,ct,2,0,"h1",3),t.YNc(2,pt,2,0,"h2",3),t.YNc(3,dt,2,0,"h2",3),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.txDonation),t.xp6(1),t.Q6J("ngIf",e.txDonation),t.xp6(1),t.Q6J("ngIf",e.txDonation)}}function ut(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.sendDonation(n.amount,n.data.to))}),t.TgZ(1,"span"),t._uU(2,"Yes, send the donation now! "),t.qZA()()}if(2&o){const e=t.oxw();t.Q6J("disabled",!e.amount)}}let mt=(()=>{class o{constructor(e,i,n,s,l){this.data=e,this._dialogRef=i,this._arweave=n,this._auth=s,this._utils=l,this.amount=0,this.maxAmount=0,this.balance=0,this._balanceSubscription=u.w0.EMPTY,this._donationSubscription=u.w0.EMPTY,this.loadingBalance=!1,this.loadingDonationInProgress=!1,this.txDonation=""}ngOnInit(){this.getBalance()}getBalance(){this.loadingBalance=!0,this.balance=0,this.maxAmount=0,this._balanceSubscription=this._arweave.getAccountBalance(this.data.mainAddress).subscribe({next:e=>{this.balance=+e,this.loadingBalance=!1,this.balance>=10?this.maxAmount=10:this.balance>0&&(this.maxAmount=this.balance)},error:e=>{this.loadingBalance=!1}})}ngOnDestroy(){this._balanceSubscription.unsubscribe(),this._donationSubscription.unsubscribe()}sendDonation(e,i){this.loadingDonationInProgress=!0,this.txDonation="";const n=this._auth.getPrivateKey();this._donationSubscription=this._arweave.sendDonation(i,`${e}`,n).subscribe({next:s=>{this.txDonation=s.id,this.loadingDonationInProgress=!1},error:s=>{this._utils.message(s,"error"),this.loadingDonationInProgress=!1}})}close(e=!1){this._dialogRef.close(e)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(m.WI),t.Y36(m.so),t.Y36(b.N),t.Y36(F.H),t.Y36(x.F))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-donate-dialog"]],decls:10,vars:6,consts:[["color","warn","mode","indeterminate","class","fadeIn",4,"ngIf"],[1,"content","border-right-special"],["class","row",4,"ngIf"],[4,"ngIf"],["align","start"],["mat-button","","mat-dialog-close","","cdkFocusInitial","",3,"disabled"],[1,"spacer"],["mat-flat-button","","cdkFocusInitial","","color","accent",3,"disabled","click",4,"ngIf"],["color","warn","mode","indeterminate",1,"fadeIn"],[1,"row"],[1,""],["tickInterval","1","step","0.00001","min","0","aria-label","AR",1,"donation-slider",3,"ngModel","disabled","max","ngModelChange"],["mat-flat-button","","cdkFocusInitial","","color","accent",3,"disabled","click"]],template:function(e,i){1&e&&(t.YNc(0,at,1,0,"mat-progress-bar",0),t.TgZ(1,"mat-dialog-content",1),t.YNc(2,rt,21,7,"div",2),t.YNc(3,lt,2,0,"div",3),t.YNc(4,gt,4,3,"div",3),t.qZA(),t.TgZ(5,"mat-dialog-actions",4)(6,"button",5),t._uU(7,"Close"),t.qZA(),t._UZ(8,"div",6),t.YNc(9,ut,3,1,"button",7),t.qZA()),2&e&&(t.Q6J("ngIf",i.loadingBalance||i.loadingDonationInProgress&&!i.txDonation),t.xp6(2),t.Q6J("ngIf",i.data.mainAddress&&!i.loadingDonationInProgress),t.xp6(1),t.Q6J("ngIf",!i.data.mainAddress),t.xp6(1),t.Q6J("ngIf",i.loadingDonationInProgress),t.xp6(2),t.Q6J("disabled",i.loadingDonationInProgress),t.xp6(3),t.Q6J("ngIf",i.data.mainAddress&&!i.loadingDonationInProgress))},dependencies:[g.O5,R.pW,f.JJ,C.lW,m.ZT,m.xY,m.H8,st.pH,f.On],styles:[".content[_ngcontent-%COMP%]{padding:10px;min-height:100px;max-width:680px;min-width:200px}.content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:6px}.title-text[_ngcontent-%COMP%]{font-weight:700}.mat-dialog-container[_ngcontent-%COMP%]{padding:0}@media (min-width: 420px){.content[_ngcontent-%COMP%]{min-width:400px}}@media (min-width: 820px){.content[_ngcontent-%COMP%]{min-width:680px}}.wallets[_ngcontent-%COMP%], .dispatch-chk[_ngcontent-%COMP%]{font-size:12px}.mat-spinner[_ngcontent-%COMP%]{display:inline;margin-left:12px}.donation-slider[_ngcontent-%COMP%]{width:100%}"]}),o})();var ft=p(39),A=p(5089),I=p(2425),ht=p(8242),Z=p(7392),h=p(3546),S=p(3848),L=p(5051);const _t=function(o){return["/",o,"edit-banner"]};function bt(o,a){if(1&o&&(t.TgZ(0,"button",22)(1,"mat-icon",23),t._uU(2,"photo_camera"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Edit banner"),t.qZA()()),2&o){const e=t.oxw();t.Q6J("routerLink",t.VKq(1,_t,e.addressList[0]))}}function xt(o,a){if(1&o&&(t.TgZ(0,"h2"),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(e.name)}}const Y=function(o){return["/",o]};function wt(o,a){if(1&o&&(t.TgZ(0,"a",24),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.Q6J("routerLink",t.VKq(2,Y,e.addressList[0])),t.xp6(1),t.hij(" ",e.username," ")}}function vt(o,a){if(1&o&&t._UZ(0,"app-arweave-address",25),2&o){const e=a.$implicit;t.Q6J("routerLink",t.VKq(2,Y,e))("address",e)}}const Ct=function(o){return["/",o,"followers"]},Pt=function(o){return["/",o,"following"]};function Tt(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"a",24),t._uU(2),t.qZA(),t.TgZ(3,"a",24),t._uU(4),t.qZA(),t.BQk()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("routerLink",t.VKq(4,Ct,e.addressList[0])),t.xp6(1),t.hij(" ",e.numFollowers>e.maxFollowers?"+"+e.maxFollowers:e.numFollowers," Followers"),t.xp6(1),t.Q6J("routerLink",t.VKq(6,Pt,e.addressList[0])),t.xp6(1),t.hij(" ",e.numFollowing>e.maxFollowing?"+"+e.maxFollowing:e.numFollowing," Following")}}const Zt=function(){return["/","logout"]};function Ft(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",26)(1,"button",27)(2,"mat-icon",28),t._uU(3,"logout"),t.qZA(),t._uU(4," Log out "),t.qZA(),t.TgZ(5,"button",29),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.scrollToEditPage())}),t.TgZ(6,"mat-icon",30),t._uU(7,"edit"),t.qZA(),t._uU(8," Edit Profile"),t.qZA(),t.TgZ(9,"button",29),t.NdJ("click",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.share(n))}),t.TgZ(10,"mat-icon",30),t._uU(11,"share"),t.qZA(),t._uU(12," Share "),t.qZA()()}2&o&&(t.xp6(1),t.Q6J("routerLink",t.DdM(1,Zt)))}function Ot(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",26)(1,"button",29),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.confirmFollowDialog(n.username,n.addressList))}),t.TgZ(2,"mat-icon",30),t._uU(3,"person_add_alt"),t.qZA(),t._uU(4," Follow "),t.qZA(),t.TgZ(5,"button",29),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.donate())}),t.TgZ(6,"mat-icon",23),t._uU(7,"monetization_on"),t.qZA(),t._uU(8," Donate "),t.qZA(),t.TgZ(9,"button",29),t.NdJ("click",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.share(n))}),t.TgZ(10,"mat-icon",30),t._uU(11,"share"),t.qZA(),t._uU(12," Share "),t.qZA()()}}function Mt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",31)(1,"button",29),t.NdJ("click",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.share(n))}),t.TgZ(2,"mat-icon",30),t._uU(3,"share"),t.qZA(),t._uU(4," Share "),t.qZA()()}}function kt(o,a){if(1&o&&(t.TgZ(0,"div",32),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.bio," ")}}const At=function(o){return{"background-image":o}},It=function(){return{exact:!0}},yt=function(){return["pending"]},Ut=function(){return["replies"]},Rt=function(){return["likes"]};let St=(()=>{class o{constructor(e,i,n,s,l,r,c,d,y,Q){this._route=e,this._arweave=i,this._auth=n,this._dialog=s,this._follow=l,this._userSettings=r,this._router=c,this._profile=d,this._utils=y,this._bottomSheetShare=Q,this.profileImage="assets/images/blank-profile.jpg",this.username="",this.addressList=[],this.bio="",this.name="",this.addressRouteParam="",this.editProfileFlag=!1,this.isLoggedIn=!1,this.maxFollowers=9,this.maxFollowing=9,this.maxFollowersQuery=20,this.maxFollowingQuery=20,this.numFollowers=0,this.numFollowing=0,this._followersSubscription=u.w0.EMPTY,this._followingSubscription=u.w0.EMPTY,this._profileSubscription=u.w0.EMPTY,this.bannerImage="",this.bannerTx=""}ngOnInit(){this._route.data.subscribe(e=>{const i=e.profile;this.profileImage="assets/images/blank-profile.jpg",this.username="",this.bio="",this.addressList=[],this.name="",i.profile?(i.profile.avatarURL&&(this.profileImage=i.profile.avatarURL),this.name=i.profile.name,this.username=i.profile.username,this.bio=i.profile.bio,this.addressList=[i.profile.address]):i.address&&(this.addressList=[i.address]);const n=this._auth.getMainAddressSnapshot();this.isLoggedIn=!!n,this.validateCurrentAddress(n),this.loadFollowers(this.addressList),this.loadFollowing(this.addressList),this.loadBannerImage(this.addressList)}),this._route.paramMap.subscribe(e=>{this.addressRouteParam=e.get("address")}),this._auth.account$.subscribe(e=>{this.isLoggedIn=!!e,this.validateCurrentAddress(e)})}validateCurrentAddress(e){this.editProfileFlag=!1,this.addressList.indexOf(e)>=0&&(this.editProfileFlag=!0)}confirmFollowDialog(e,i){const n=this._userSettings.getDefaultLang(),s=this._userSettings.getLangObject(n);this._dialog.open(ot,{restoreFocus:!1,autoFocus:!1,disableClose:!0,data:{content:`Do you really want to follow ${e}?`,closeLabel:"No",confirmLabel:"Yes, I want to follow this user",wallets:i,username:e},direction:s&&"LTR"===s.writing_system?"ltr":"rtl"}).afterClosed().subscribe(c=>{})}loadFollowers(e){this.numFollowers=0,this._followersSubscription=this._arweave.getNetworkInfo().pipe((0,w.w)(i=>this._follow.getFollowers(e,this.maxFollowersQuery,i.height))).subscribe({next:i=>{this.numFollowers=new Set(i.map(n=>n.owner)).size},error:i=>{console.error("ErrFollowers",i)}})}loadFollowing(e){this.numFollowing=0,this._followingSubscription=this._arweave.getNetworkInfo().pipe((0,w.w)(i=>this._follow.getFollowing(e,this.maxFollowingQuery,i.height))).subscribe({next:i=>{const n=[];for(const s of i){const l=this.extractTagsFromTx(s);if(l.username&&n.indexOf(l.username)<0)n.push(l.username),this.numFollowing++;else if(!l.username){let r=!1;for(const c of l.wallets)n.indexOf(c)<0&&!r&&(this.numFollowing++,r=!0),n.push(c)}}},error:i=>{console.error("ErrFollowing",i)}})}ngOnDestroy(){this._followingSubscription.unsubscribe(),this._followersSubscription.unsubscribe(),this._profileSubscription.unsubscribe()}donate(){const e=this._userSettings.getDefaultLang(),i=this._userSettings.getLangObject(e);let n=i&&"LTR"===i.writing_system?"ltr":"rtl";const s=this._auth.getMainAddressSnapshot();this._dialog.open(mt,{data:{mainAddress:s,to:this.addressList[0]?this.addressList[0]:""},direction:n,disableClose:!0}).afterClosed().subscribe(function(){var c=(0,H.Z)(function*(d){});return function(d){return c.apply(this,arguments)}}())}extractTagsFromTx(e){const i=e&&e.tags?e.tags:[],n={username:"",wallets:[]};for(const s of i)"Wallet"===s.name?this._arweave.validateAddress(s.value)?n.wallets.push(s.value):console.error("Invalid wallet tag",s):"Username"===s.name&&(n.username=s.value.trim());return n}scrollToEditPage(){this._router.navigate(["/",this.addressList[0],"edit"])}getImageUrl(e){return this._arweave.getImageUrl(e)}loadBannerImage(e){this._profileSubscription=this._arweave.getNetworkInfo().pipe((0,w.w)(n=>this._profile.getBannerImg(e,10,n.height))).subscribe({next:n=>{const s=n[0],r=this._utils.sanitizeFull(this.findTag(s&&s.tags?s.tags:[],"Img-Src-Id"));this.bannerImage="",this.bannerTx="",r&&this._arweave.validateAddress(r)&&(this.bannerImage=this.getImageUrl(r),this.bannerTx=r)},error:n=>{console.error("BannerImg",n)}})}findTag(e,i){for(const n of e)if(n.name===i)return n.value?n.value.trim():"";return""}share(e){e.stopPropagation(),this._userSettings.getDefaultLang();const l=this.addressList[0],c=this._utils.sanitizeFull(`Profile ${l}`);this._bottomSheetShare.open(ft.n,{data:{title:"Public Square",content:this._utils.sanitizeFull(`${c} ...`.substr(0,200)),img:"",fullURL:`${this._utils.getBaseURL()}#/${l}`},direction:"ltr",ariaLabel:"Share on social media"})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(_.gz),t.Y36(b.N),t.Y36(F.H),t.Y36(m.uw),t.Y36(k.R),t.Y36(A.s),t.Y36(_.F0),t.Y36(I.H),t.Y36(x.F),t.Y36(ht.ch))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-profile"]],decls:32,vars:29,consts:[[1,"fadeIn"],[1,"profile-header","mat-elevation-z2","pacific-dream","text-right",3,"ngStyle"],["mat-button","","class","banner-img-btn",3,"routerLink",4,"ngIf"],[1,"profile-subheader"],[1,"profile-img"],["mat-card-avatar","",1,"avatar","border-same-as-background","mat-elevation-z2",3,"src"],[1,"profile-info"],[4,"ngIf"],["class","small-username user-link",3,"routerLink",4,"ngIf"],["class","small-username address user-link",3,"routerLink","address",4,"ngFor","ngForOf"],["class","profile-actions",4,"ngIf"],["class","extra-actions",4,"ngIf"],["class","bio",4,"ngIf"],[1,"col-body"],["mat-tab-nav-bar","","color","accent",1,"mat-elevation-z1",3,"tabPanel"],["mat-tab-link","","routerLinkActive","active",3,"routerLink","routerLinkActiveOptions","active"],["rlStories","routerLinkActive"],["mat-tab-link","","routerLinkActive","active",3,"active","routerLink"],["rlPending","routerLinkActive"],["rlReply","routerLinkActive"],["rlLike","routerLinkActive"],["tabPanel",""],["mat-button","",1,"banner-img-btn",3,"routerLink"],["color","accent",1,"material-icons-outlined"],[1,"small-username","user-link",3,"routerLink"],[1,"small-username","address","user-link",3,"routerLink","address"],[1,"profile-actions"],["mat-stroked-button","",3,"routerLink"],["color","warn"],["mat-stroked-button","",3,"click"],["color","accent"],[1,"extra-actions"],[1,"bio"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,bt,5,3,"button",2),t.qZA(),t.TgZ(3,"div",3)(4,"div",4),t._UZ(5,"img",5),t.qZA(),t.TgZ(6,"div",6),t.YNc(7,xt,2,1,"h2",7),t.YNc(8,wt,2,4,"a",8),t.YNc(9,vt,1,4,"app-arweave-address",9),t.YNc(10,Tt,5,8,"ng-container",7),t.qZA(),t.YNc(11,Ft,13,2,"div",10),t.YNc(12,Ot,13,0,"div",10),t.YNc(13,Mt,5,0,"div",11),t.qZA(),t.YNc(14,kt,2,1,"div",12),t.TgZ(15,"div",13)(16,"nav",14)(17,"a",15,16),t._uU(19," Stories"),t.qZA(),t.TgZ(20,"a",17,18),t._uU(22," Pending "),t.qZA(),t.TgZ(23,"a",17,19),t._uU(25," Replies "),t.qZA(),t.TgZ(26,"a",17,20),t._uU(28," Likes "),t.qZA()(),t.TgZ(29,"mat-tab-nav-panel",null,21),t._UZ(31,"router-outlet"),t.qZA()()()),2&e){const n=t.MAs(18),s=t.MAs(21),l=t.MAs(24),r=t.MAs(27),c=t.MAs(30);t.xp6(1),t.Q6J("ngStyle",t.VKq(21,At,i.bannerImage?"url("+i.bannerImage+")":"")),t.xp6(1),t.Q6J("ngIf",i.editProfileFlag),t.xp6(3),t.Q6J("src",i.profileImage,t.LSH),t.xp6(2),t.Q6J("ngIf",i.name),t.xp6(1),t.Q6J("ngIf",i.username),t.xp6(1),t.Q6J("ngForOf",i.addressList),t.xp6(1),t.Q6J("ngIf",i.addressList[0]),t.xp6(1),t.Q6J("ngIf",i.editProfileFlag),t.xp6(1),t.Q6J("ngIf",!i.editProfileFlag&&i.isLoggedIn),t.xp6(1),t.Q6J("ngIf",!(!i.editProfileFlag&&i.isLoggedIn||i.editProfileFlag)),t.xp6(1),t.Q6J("ngIf",i.bio),t.xp6(2),t.Q6J("tabPanel",c),t.xp6(1),t.Q6J("routerLink",t.VKq(23,Y,i.addressRouteParam))("routerLinkActiveOptions",t.DdM(25,It))("active",n.isActive),t.xp6(3),t.Q6J("active",s.isActive)("routerLink",t.DdM(26,yt)),t.xp6(3),t.Q6J("active",l.isActive)("routerLink",t.DdM(27,Ut)),t.xp6(3),t.Q6J("active",r.isActive)("routerLink",t.DdM(28,Rt))}},dependencies:[g.sg,g.O5,g.PC,_.lC,_.rH,_.yS,_.Od,Z.Hw,C.lW,h.kc,S.BU,S.sW,S.Nj,L.N],styles:[".col-body[_ngcontent-%COMP%]{width:100%;min-height:620px;margin-top:20px}.no-results[_ngcontent-%COMP%]{padding:20px;text-align:center;font-style:italic}.profile-header[_ngcontent-%COMP%]{height:180px;background-image:none;background-position:center!important;background-repeat:no-repeat!important;background-size:cover!important;position:relative}.profile-header.socialive[_ngcontent-%COMP%]{background:#159957;background:linear-gradient(to right,#155799,#159957)}.profile-header.frozen[_ngcontent-%COMP%]{background:#403B4A;background:linear-gradient(to right,#E7E9BB,#403B4A)}.profile-header.celestial[_ngcontent-%COMP%]{background:#C33764;background:linear-gradient(to right,#1D2671,#C33764)}.profile-header.vision-of-grandeur[_ngcontent-%COMP%]{background:#000046;background:linear-gradient(to right,#1CB5E0,#000046)}.profile-header.what-lies-beyond[_ngcontent-%COMP%]{background:#F0F2F0;background:linear-gradient(to right,#000C40,#F0F2F0)}.profile-header.pacific-dream[_ngcontent-%COMP%]{background:#34e89e;background:linear-gradient(to right,#0f3443,#34e89e)}.profile-subheader[_ngcontent-%COMP%]{max-width:1000px;margin:-14px auto 0;min-height:80px;overflow:auto;position:relative}.profile-img[_ngcontent-%COMP%]{width:100%;text-align:center}.profile-info[_ngcontent-%COMP%]{width:100%;text-align:center;padding-top:20px;padding-left:0}.profile-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:6px}.profile-actions[_ngcontent-%COMP%], .extra-actions[_ngcontent-%COMP%]{width:100%;text-align:center;padding-top:4px}.profile-actions[_ngcontent-%COMP%]   .mat-stroked-button[_ngcontent-%COMP%], .profile-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%], .extra-actions[_ngcontent-%COMP%]   .mat-stroked-button[_ngcontent-%COMP%], .extra-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]{margin-left:10px;margin-bottom:6px}.avatar[_ngcontent-%COMP%]{width:160px;height:160px;border-radius:50%;flex-shrink:0;object-fit:cover;border:2px solid}@media (min-width: 800px){.profile-img[_ngcontent-%COMP%]{float:left;width:20%}.profile-info[_ngcontent-%COMP%]{float:left;width:40%;text-align:left;padding-top:60px;padding-left:10px}.profile-actions[_ngcontent-%COMP%], .extra-actions[_ngcontent-%COMP%]{width:40%;float:left;padding-top:60px;text-align:right}.address[_ngcontent-%COMP%]{justify-content:left!important}.extra-actions[_ngcontent-%COMP%]{text-align:right}}.address[_ngcontent-%COMP%]{font-size:12px;font-weight:400;justify-content:center}.bio[_ngcontent-%COMP%]{font-size:14px;text-align:center;padding-top:12px}.user-link[_ngcontent-%COMP%]{text-decoration:none;margin-bottom:6px;display:block;cursor:pointer}.user-link[_ngcontent-%COMP%]:hover{filter:brightness(160%)}.active[_ngcontent-%COMP%]{opacity:1}.mat-tab-label[_ngcontent-%COMP%], .mat-tab-link[_ngcontent-%COMP%]{letter-spacing:1px}.banner-img-btn[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0;margin-bottom:10px}.banner-img-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:10px;text-shadow:1px 1px 1px #FFFFFF,2px 2px 2px #000000}"]}),o})();var D=p(8458),Lt=p(4850),T=p(3238),N=p(2413);function Yt(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-user-card",9),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.close())}),t.qZA(),t.TgZ(2,"div",10),t._uU(3),t.qZA(),t._UZ(4,"mat-divider"),t.BQk()}if(2&o){const e=a.$implicit,i=t.oxw();t.xp6(1),t.Q6J("address",e.owner),t.xp6(2),t.Oqu(i.timestampToDate(e.blockTimestamp))}}function Dt(o,a){1&o&&t._UZ(0,"mat-spinner",11)}function Nt(o,a){1&o&&(t.TgZ(0,"div",12),t._uU(1," No results. "),t.qZA())}function Jt(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-card",13),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.moreResults())}),t.TgZ(1,"mat-card-content",14),t._uU(2," Show more "),t.qZA()()}}let Et=(()=>{class o{constructor(e,i,n,s,l){this._dialogRef=e,this.data=i,this._utils=n,this._like=s,this._arweave=l,this.loadingLikes=!1,this._likesSubscription=u.w0.EMPTY,this._nextLikesSubscription=u.w0.EMPTY,this._maxLikes=10,this.likesList=[],this.moreResultsAvailable=!0}ngOnInit(){this.loadLikes()}loadLikes(){this.loadingLikes=!0,this.likesList=[];const e=this.data.postId;this._likesSubscription=this._arweave.getNetworkInfo().pipe((0,w.w)(i=>this._like.getStoryLikes(e,this._maxLikes,i.height))).subscribe({next:i=>{(!i||!i.length)&&(this.moreResultsAvailable=!1),this.likesList.push(...i),this.loadingLikes=!1},error:i=>{this.loadingLikes=!1,this._utils.message(i,"error")}})}close(){this._dialogRef.close()}ngOnDestroy(){this._likesSubscription.unsubscribe(),this._nextLikesSubscription.unsubscribe()}timestampToDate(e){return this._utils.dateFormat(e=e||"")}moreResults(){this.loadingLikes=!0,this._nextLikesSubscription=this._like.next().subscribe({next:e=>{(!e||!e.length)&&(this.moreResultsAvailable=!1),this.likesList.push(...e),this.loadingLikes=!1},error:e=>{this.loadingLikes=!1,this._utils.message(e,"error")}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(m.so),t.Y36(m.WI),t.Y36(x.F),t.Y36(D.n),t.Y36(b.N))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-view-likes-dialog"]],decls:11,vars:4,consts:[["mat-dialog-title",""],[1,"content","border-right-special"],[4,"ngFor","ngForOf"],[1,"more-results-container"],["color","accent","diameter","32",4,"ngIf"],["class","no-results",4,"ngIf"],["class","more-results-card mat-elevation-z0","matRipple","",3,"click",4,"ngIf"],["align","end"],["mat-button","","cdkFocusInitial","",3,"click"],[3,"address","click"],[1,"list-number","text-right"],["color","accent","diameter","32"],[1,"no-results"],["matRipple","",1,"more-results-card","mat-elevation-z0",3,"click"],[1,"more-results","text-center"]],template:function(e,i){1&e&&(t.TgZ(0,"h1",0),t._uU(1,"Likes"),t.qZA(),t.TgZ(2,"mat-dialog-content",1),t.YNc(3,Yt,5,2,"ng-container",2),t.TgZ(4,"div",3),t.YNc(5,Dt,1,0,"mat-spinner",4),t.YNc(6,Nt,2,0,"div",5),t.YNc(7,Jt,3,0,"mat-card",6),t.qZA()(),t.TgZ(8,"mat-dialog-actions",7)(9,"button",8),t.NdJ("click",function(){return i.close()}),t._uU(10,"Close"),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("ngForOf",i.likesList),t.xp6(2),t.Q6J("ngIf",i.loadingLikes),t.xp6(1),t.Q6J("ngIf",!i.likesList.length&&!i.loadingLikes),t.xp6(1),t.Q6J("ngIf",!i.loadingLikes&&i.moreResultsAvailable))},dependencies:[g.sg,g.O5,Lt.d,h.a8,h.dn,C.lW,T.wG,v.Ou,m.uh,m.xY,m.H8,N.r],styles:[".content[_ngcontent-%COMP%]{padding:10px;min-height:100px;max-width:480px;min-width:200px}.content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:6px}.mat-dialog-container[_ngcontent-%COMP%]{padding:0}.mat-dialog-content[_ngcontent-%COMP%]{border-top:1px solid}@media (min-width: 420px){.content[_ngcontent-%COMP%]{min-width:400px}}@media (min-width: 820px){.content[_ngcontent-%COMP%]{min-width:480px}}.mat-spinner[_ngcontent-%COMP%]{margin:0 auto}.list-number[_ngcontent-%COMP%]{font-weight:700;z-index:100;font-size:12px;font-style:italic;width:100%;padding:10px}.more-results[_ngcontent-%COMP%]{font-weight:700;font-style:italic}.more-results-card[_ngcontent-%COMP%]{cursor:pointer;border-radius:0;width:100%;margin-top:20px;height:50px}.more-results-container[_ngcontent-%COMP%]{padding-top:20px}.no-results[_ngcontent-%COMP%]{padding:20px;text-align:center;font-style:italic}"]}),o})();var B=p(4135),j=p(4777),O=p(3275),J=p(4463);const qt=["moreResultsCard"];function Qt(o,a){1&o&&(t.TgZ(0,"div",10),t._uU(1," No results."),t.qZA())}function zt(o,a){if(1&o&&(t.TgZ(0,"div",11),t._UZ(1,"app-post-card",12),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("post",e.post)("fullMode",!0)}}function Ht(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"a",13),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.viewLikes())}),t.TgZ(1,"mat-icon",14),t._uU(2,"favorite"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(4),t.hij("",e.likes.length>e.maxLikes?"+"+e.maxLikes:e.likes.length," Likes")}}function Bt(o,a){1&o&&t._UZ(0,"app-post-card",12),2&o&&t.Q6J("post",a.$implicit)("fullMode",!1)}function jt(o,a){if(1&o&&(t.TgZ(0,"div",11),t.YNc(1,Bt,1,2,"app-post-card",15),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.replies)}}function Gt(o,a){1&o&&t._UZ(0,"mat-spinner",16)}function Vt(o,a){1&o&&(t.TgZ(0,"div",10),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"GENERAL.LABELS.NO_RESULTS")," "))}let Kt=(()=>{class o{constructor(e,i,n,s,l,r,c,d){this.route=e,this._arweave=i,this._post=n,this._utils=s,this._reply=l,this._like=r,this._userSettings=c,this._dialog=d,this.post=null,this.loadingPost=!1,this._postSubscription=u.w0.EMPTY,this.addressList=[],this.loadingReplies=!1,this.replies=[],this._repliesSubscription=u.w0.EMPTY,this._nextRepliesSubscription=u.w0.EMPTY,this._maxReplies=10,this.moreResultsAvailable=!0,this.loadingLikes=!1,this.likes=[],this._likesSubscription=u.w0.EMPTY,this.maxLikes=9,this.maxLikesQuery=20}ngOnInit(){this.route.parent.data.subscribe(e=>{const i=this.route.snapshot.paramMap.get("storyId"),n=e.profile;this.loadPost(n.profile?[n.profile.address]:[n.address],i),this.loadReplies(i),this.loadLikes(i)})}ngOnDestroy(){this._postSubscription.unsubscribe(),this._repliesSubscription.unsubscribe(),this._nextRepliesSubscription.unsubscribe(),this._likesSubscription.unsubscribe()}loadPost(e,i){this.loadingPost=!0,this.post=null,this._postSubscription=this._post.getPost("string"==typeof e?[e]:e,i).subscribe({next:s=>{this.post=s,this.loadingPost=!1},error:s=>{this.loadingPost=!1,console.error("postLoadPost",s)}})}loadReplies(e){this.loadingReplies=!0,this.replies=[],this._repliesSubscription=this._arweave.getNetworkInfo().pipe((0,w.w)(i=>this._reply.getReplies(e,this._maxReplies,i.height))).subscribe({next:i=>{this.replies=i,this.loadingReplies=!1},error:i=>{this.loadingReplies=!1,this._utils.message(i,"error")}})}moreReplies(){this.loadingReplies=!0,this._nextRepliesSubscription=this._reply.next().subscribe({next:e=>{e&&e.length?this.replies.push(...e):this.moreResultsAvailable=!1,this.loadingReplies=!1},error:e=>{this.loadingReplies=!1,this.moreResultsAvailable=!1,this._utils.message(e,"error")}})}loadLikes(e){this.loadingReplies=!0,this.likes=[],this._repliesSubscription=this._arweave.getNetworkInfo().pipe((0,w.w)(i=>this._like.getStoryLikes(e,this.maxLikesQuery,i.height))).subscribe({next:i=>{for(const n of i)this.likes.find(s=>s.id===n.id)||this.likes.push(n);this.loadingLikes=!1},error:i=>{this.loadingLikes=!1,this._utils.message(i,"error")}})}viewLikes(){const e=this._userSettings.getDefaultLang(),i=this._userSettings.getLangObject(e);this._dialog.open(Et,{restoreFocus:!1,autoFocus:!1,disableClose:!1,data:{postId:this.post?this.post.id:0},direction:i&&"LTR"===i.writing_system?"ltr":"rtl"}).afterClosed().subscribe(()=>{})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(_.gz),t.Y36(b.N),t.Y36(B.L),t.Y36(x.F),t.Y36(j.Y),t.Y36(D.n),t.Y36(A.s),t.Y36(m.uw))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-post"]],viewQuery:function(e,i){if(1&e&&t.Gf(qt,5,t.SBq),2&e){let n;t.iGM(n=t.CRH())&&(i.moreResultsCard=n.first)}},decls:15,vars:11,consts:[["class","no-results",4,"ngIf"],["class","post-list-container",4,"ngIf"],[1,"text-center"],["mat-button","","class","likes-subtitle",3,"click",4,"ngIf"],[1,"replies-subtitle"],[1,"more-results-container"],["color","accent","diameter","32",4,"ngIf"],["matRipple","",1,"more-results-card","mat-elevation-z0",3,"click"],["moreResultsCard",""],[1,"more-results","text-center"],[1,"no-results"],[1,"post-list-container"],[3,"post","fullMode"],["mat-button","",1,"likes-subtitle",3,"click"],["aria-label","Likes","color","warn"],[3,"post","fullMode",4,"ngFor","ngForOf"],["color","accent","diameter","32"]],template:function(e,i){1&e&&(t.YNc(0,Qt,2,0,"div",0),t.YNc(1,zt,2,2,"div",1),t.TgZ(2,"div",2),t.YNc(3,Ht,5,1,"a",3),t.qZA(),t.TgZ(4,"h3",4),t._uU(5,"Replies:"),t.qZA(),t.YNc(6,jt,2,1,"div",1),t.TgZ(7,"div",5),t.YNc(8,Gt,1,0,"mat-spinner",6),t.YNc(9,Vt,3,3,"div",0),t.TgZ(10,"mat-card",7,8),t.NdJ("click",function(){return i.moreReplies()}),t.TgZ(12,"mat-card-content",9),t._uU(13),t.ALo(14,"translate"),t.qZA()()()),2&e&&(t.Q6J("ngIf",!i.loadingPost&&!i.post),t.xp6(1),t.Q6J("ngIf",i.post&&!i.loadingPost),t.xp6(2),t.Q6J("ngIf",!i.loadingPost&&!i.loadingLikes),t.xp6(3),t.Q6J("ngIf",i.post&&!i.loadingPost),t.xp6(2),t.Q6J("ngIf",i.loadingPost||i.loadingReplies),t.xp6(1),t.Q6J("ngIf",!i.replies.length&&!i.loadingReplies),t.xp6(1),t.Udp("visibility",!i.loadingReplies&&i.moreResultsAvailable&&i.replies.length?"visible":"hidden"),t.xp6(3),t.hij(" ",t.lcZ(14,9,"GENERAL.LABELS.SHOW_OLDER_RESULTS")," "))},dependencies:[g.sg,g.O5,Z.Hw,C.zs,h.a8,h.dn,T.wG,v.Ou,O.i,J.X$],styles:[".mat-spinner[_ngcontent-%COMP%]{margin:0 auto}.no-results[_ngcontent-%COMP%]{padding:20px;text-align:center;font-style:italic}.post-list-container[_ngcontent-%COMP%]{padding-top:2px}.replies-subtitle[_ngcontent-%COMP%]{padding:20px;margin:10px 0}.more-results-card[_ngcontent-%COMP%]{cursor:pointer;border-radius:0;width:100%;margin-top:20px;height:50px;margin-bottom:60px}.more-results-container[_ngcontent-%COMP%]{padding-top:20px}.more-results[_ngcontent-%COMP%]{font-weight:700;font-style:italic}.likes-subtitle[_ngcontent-%COMP%]{padding:20px;margin:10px 0;font-size:12px;font-style:italic}.likes-subtitle[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:14px!important;width:14px;height:14px}.likes-subtitle[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:10px}"]}),o})();var $t=p(8505),Xt=p(515),Wt=p(9646),te=p(262);let M=(()=>{class o{constructor(e,i,n,s,l){this._profile=e,this._route=i,this._utils=n,this._arweave=s,this._router=l,this.profileAddress=null,this.loading=!1}resolve(e,i){const n=e.paramMap.get("address")?e.paramMap.get("address"):e.parent&&e.parent.paramMap.get("address")?e.parent.paramMap.get("address"):"";return this.profileAddress=null,this.loading=!0,this.loadProfile(n).pipe((0,$t.b)(s=>{this.profileAddress=s,this.loading=!1}),(0,te.K)(s=>(console.error("ProfileResolver:",s),this.loading=!1,this._router.navigate(["/","profile-not-found"]),Xt.E)))}loadProfile(e){return this._profile.getProfileByAddress(e).pipe((0,w.w)(i=>{const n={address:"",profile:null};if(i)n.profile=i,n.address=e;else{if(!this._arweave.validateAddress(e))throw Error(`Profile not found/incorrect address ${e}`);n.address=e}return(0,Wt.of)(n)}))}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(I.H),t.LFG(_.gz),t.LFG(x.F),t.LFG(b.N),t.LFG(_.F0))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var P=p(1250);const ee=["moreResultsCard"];function ie(o,a){1&o&&(t.TgZ(0,"div",8),t._uU(1," No results."),t.qZA())}function ne(o,a){1&o&&t._UZ(0,"app-post-card",9),2&o&&t.Q6J("post",a.$implicit)}function oe(o,a){1&o&&t._UZ(0,"mat-spinner",10)}function se(o,a){1&o&&(t.TgZ(0,"div",8),t._uU(1," There are no posts yet! "),t.qZA())}let ae=(()=>{class o{constructor(e,i,n,s,l,r,c){this.route=e,this._arweave=i,this._post=n,this._utils=s,this._profileResolver=l,this._appSettings=r,this._ngZone=c,this.posts=[],this.maxPosts=10,this.loadingPosts=!1,this._postSubscription=u.w0.EMPTY,this._nextResultsSubscription=u.w0.EMPTY,this.moreResultsAvailable=!0,this.addressList=[]}ngOnInit(){this.route.data.subscribe(e=>{const i=e.profile;this.loadPosts(i.profile&&i.profile.address?[i.profile.address]:[i.address])}),this._appSettings.scrollTopStream.subscribe(e=>{this._ngZone.run(()=>{const i=this.moreResultsCard.nativeElement.offsetTop-this.moreResultsCard.nativeElement.scrollTop;e>i-700&&i&&!this.loadingPosts&&this.moreResultsAvailable&&this.moreResults()})})}ngOnDestroy(){this._postSubscription.unsubscribe(),this._nextResultsSubscription.unsubscribe()}loadPosts(e){this.loadingPosts=!0,this.posts=[],this._postSubscription=this._arweave.getNetworkInfo().pipe((0,w.w)(i=>this._post.getLatestPosts("string"==typeof e?[e]:e,this.maxPosts,i.height,!0))).subscribe({next:i=>{(!i||!i.length)&&(this.moreResultsAvailable=!1),this.posts=i,this.loadingPosts=!1},error:i=>{this.loadingPosts=!1,this.moreResultsAvailable=!1,this._utils.message(i,"error")}})}moreResults(){this.loadingPosts=!0,this._nextResultsSubscription=this._post.next().subscribe({next:e=>{(!e||!e.length)&&(this.moreResultsAvailable=!1),this.posts=this.posts.concat(e),this.loadingPosts=!1},error:e=>{this.loadingPosts=!1,this._utils.message(e,"error")}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(_.gz),t.Y36(b.N),t.Y36(B.L),t.Y36(x.F),t.Y36(M),t.Y36(P.X),t.Y36(t.R0b))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-latest-stories"]],viewQuery:function(e,i){if(1&e&&t.Gf(ee,5,t.SBq),2&e){let n;t.iGM(n=t.CRH())&&(i.moreResultsCard=n.first)}},decls:10,vars:6,consts:[["class","no-results",4,"ngIf"],[1,"post-list-container"],[3,"post",4,"ngFor","ngForOf"],[1,"more-results-container"],["color","accent","diameter","32",4,"ngIf"],["matRipple","",1,"more-results-card","mat-elevation-z0",3,"click"],["moreResultsCard",""],[1,"more-results","text-center"],[1,"no-results"],[3,"post"],["color","accent","diameter","32"]],template:function(e,i){1&e&&(t.YNc(0,ie,2,0,"div",0),t.TgZ(1,"div",1),t.YNc(2,ne,1,1,"app-post-card",2),t.qZA(),t.TgZ(3,"div",3),t.YNc(4,oe,1,0,"mat-spinner",4),t.YNc(5,se,2,0,"div",0),t.TgZ(6,"mat-card",5,6),t.NdJ("click",function(){return i.moreResults()}),t.TgZ(8,"mat-card-content",7),t._uU(9," Show older posts "),t.qZA()()()),2&e&&(t.Q6J("ngIf",!i.posts),t.xp6(2),t.Q6J("ngForOf",i.posts),t.xp6(2),t.Q6J("ngIf",i.loadingPosts),t.xp6(1),t.Q6J("ngIf",!i.posts.length&&!i.loadingPosts),t.xp6(1),t.Udp("visibility",!i.loadingPosts&&i.moreResultsAvailable?"visible":"hidden"))},dependencies:[g.sg,g.O5,h.a8,h.dn,T.wG,v.Ou,O.i],styles:[".more-results[_ngcontent-%COMP%]{font-weight:700;font-style:italic}.more-results-card[_ngcontent-%COMP%]{cursor:pointer;border-radius:0;width:100%;margin-top:20px;height:50px}.more-results-container[_ngcontent-%COMP%]{padding-top:20px}.mat-spinner[_ngcontent-%COMP%]{margin:0 auto}.no-results[_ngcontent-%COMP%]{padding:20px;text-align:center;font-style:italic}.post-list-container[_ngcontent-%COMP%]{padding-top:2px}"]}),o})();const re=["moreResultsCard"];function le(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"h4",8)(2,"mat-icon",9),t._uU(3,"reply"),t.qZA(),t._uU(4),t.qZA(),t._UZ(5,"app-post-card",10)(6,"app-post-card",11),t.BQk()),2&o){const e=a.$implicit,i=t.oxw();t.xp6(4),t.hij(" ",i.mainUsername," replied: "),t.xp6(1),t.Q6J("post",e)("fullMode",!1),t.xp6(1),t.Q6J("txId",i.extractTagFromTx(e,"In-Reply-To"))("fullMode",!1)}}function ce(o,a){1&o&&t._UZ(0,"mat-spinner",12)}function pe(o,a){1&o&&(t.TgZ(0,"div",13),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"GENERAL.LABELS.NO_RESULTS")," "))}let de=(()=>{class o{constructor(e,i,n,s,l,r){this.route=e,this._arweave=i,this._utils=n,this._reply=s,this._appSettings=l,this._ngZone=r,this.loadingReplies=!1,this.replies=[],this._repliesSubscription=u.w0.EMPTY,this._nextResultsSubscription=u.w0.EMPTY,this._maxReplies=10,this.moreResultsAvailable=!0,this.mainUsername=""}ngOnInit(){this.route.parent.data.subscribe(e=>{this.route.snapshot.paramMap.get("storyId");const n=e.profile,s=n.profile&&n.profile.address?[n.profile.address]:[n.address];this.mainUsername=n.profile&&n.profile.username?n.profile.username:n.address,this.loadReplies(s)}),this._appSettings.scrollTopStream.subscribe(e=>{this._ngZone.run(()=>{const i=this.moreResultsCard.nativeElement.offsetTop-this.moreResultsCard.nativeElement.scrollTop;e>i-700&&i&&!this.loadingReplies&&this.moreResultsAvailable&&this.moreResults()})})}ngOnDestroy(){this._repliesSubscription.unsubscribe(),this._nextResultsSubscription.unsubscribe()}loadReplies(e){this.loadingReplies=!0,this.replies=[],this._repliesSubscription=this._arweave.getNetworkInfo().pipe((0,w.w)(i=>this._reply.getRepliesFromUser(e,this._maxReplies,i.height))).subscribe({next:i=>{(!i||!i.length)&&(this.moreResultsAvailable=!1),this.replies.push(...i),this.loadingReplies=!1},error:i=>{this.loadingReplies=!1,this._utils.message(i,"error")}})}moreResults(){this.loadingReplies=!0,this._nextResultsSubscription=this._reply.nextRepliesFromUser().subscribe({next:e=>{(!e||!e.length)&&(this.moreResultsAvailable=!1),this.replies.push(...e),this.loadingReplies=!1},error:e=>{this.loadingReplies=!1,this.moreResultsAvailable=!1,this._utils.message(e,"error")}})}extractTagFromTx(e,i){const n=e.tags?e.tags:[];for(const s of n)if(s.name===i)return s.value;return null}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(_.gz),t.Y36(b.N),t.Y36(x.F),t.Y36(j.Y),t.Y36(P.X),t.Y36(t.R0b))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-replies"]],viewQuery:function(e,i){if(1&e&&t.Gf(re,5,t.SBq),2&e){let n;t.iGM(n=t.CRH())&&(i.moreResultsCard=n.first)}},decls:10,vars:8,consts:[[1,"post-list-container"],[4,"ngFor","ngForOf"],[1,"more-results-container"],["color","accent","diameter","32",4,"ngIf"],["class","no-results",4,"ngIf"],["matRipple","",1,"more-results-card","mat-elevation-z0",3,"click"],["moreResultsCard",""],[1,"more-results","text-center"],[1,"label-replied"],["aria-label","Likes","color","accent"],[3,"post","fullMode"],[3,"txId","fullMode"],["color","accent","diameter","32"],[1,"no-results"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.YNc(1,le,7,5,"ng-container",1),t.qZA(),t.TgZ(2,"div",2),t.YNc(3,ce,1,0,"mat-spinner",3),t.YNc(4,pe,3,3,"div",4),t.TgZ(5,"mat-card",5,6),t.NdJ("click",function(){return i.moreResults()}),t.TgZ(7,"mat-card-content",7),t._uU(8),t.ALo(9,"translate"),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("ngForOf",i.replies),t.xp6(2),t.Q6J("ngIf",i.loadingReplies),t.xp6(1),t.Q6J("ngIf",!i.replies.length&&!i.loadingReplies),t.xp6(1),t.Udp("visibility",!i.loadingReplies&&i.moreResultsAvailable?"visible":"hidden"),t.xp6(3),t.hij(" ",t.lcZ(9,6,"GENERAL.LABELS.SHOW_OLDER_RESULTS")," "))},dependencies:[g.sg,g.O5,Z.Hw,h.a8,h.dn,T.wG,v.Ou,O.i,J.X$],styles:[".no-results[_ngcontent-%COMP%]{padding:20px;text-align:center;font-style:italic}.replies-subtitle[_ngcontent-%COMP%]{padding:20px;margin:10px 0 0}.mat-spinner[_ngcontent-%COMP%]{margin:0 auto}.label-replied[_ngcontent-%COMP%]{padding:20px;margin:10px 0 0}.more-results-container[_ngcontent-%COMP%]{padding-top:20px}"]}),o})();const ge=["moreResultsCard"];function ue(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"h4",8)(2,"mat-icon",9),t._uU(3,"favorite"),t.qZA(),t._uU(4),t.qZA(),t._UZ(5,"app-post-card",10),t.BQk()),2&o){const e=a.$implicit,i=t.oxw();t.xp6(4),t.hij(" ",i.mainUsername," liked:"),t.xp6(1),t.Q6J("txId",i.extractTagFromTx(e,"Like-Target"))("fullMode",!1)}}function me(o,a){1&o&&t._UZ(0,"mat-spinner",11)}function fe(o,a){1&o&&(t.TgZ(0,"div",12),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&o&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"GENERAL.LABELS.NO_RESULTS")," "))}let he=(()=>{class o{constructor(e,i,n,s,l,r){this.route=e,this._arweave=i,this._utils=n,this._like=s,this._appSettings=l,this._ngZone=r,this.loadingLikes=!1,this.likes=[],this._likesSubscription=u.w0.EMPTY,this._nextResultsSubscription=u.w0.EMPTY,this._maxLikes=10,this.moreResultsAvailable=!0,this.mainUsername=""}ngOnInit(){this.route.parent.data.subscribe(e=>{this.route.snapshot.paramMap.get("storyId");const n=e.profile,s=n.profile&&n.profile.address?[n.profile.address]:[n.address];this.mainUsername=n.profile&&n.profile.username?n.profile.username:n.address,this.loadLikes(s)}),this._appSettings.scrollTopStream.subscribe(e=>{this._ngZone.run(()=>{const i=this.moreResultsCard.nativeElement.offsetTop-this.moreResultsCard.nativeElement.scrollTop;e>i-700&&i&&!this.loadingLikes&&this.moreResultsAvailable&&this.moreResults()})})}ngOnDestroy(){this._likesSubscription.unsubscribe(),this._nextResultsSubscription.unsubscribe()}loadLikes(e){this.loadingLikes=!0,this.likes=[],this._likesSubscription=this._arweave.getNetworkInfo().pipe((0,w.w)(i=>this._like.getLikesFromUser(e,this._maxLikes,i.height))).subscribe({next:i=>{(!i||!i.length)&&(this.moreResultsAvailable=!1),this.likes.push(...i),this.loadingLikes=!1},error:i=>{this.loadingLikes=!1,this._utils.message(i,"error")}})}moreResults(){this.loadingLikes=!0,this._nextResultsSubscription=this._like.nextLikesFromUser().subscribe({next:e=>{(!e||!e.length)&&(this.moreResultsAvailable=!1),this.likes.push(...e),this.loadingLikes=!1},error:e=>{this.loadingLikes=!1,this.moreResultsAvailable=!1,this._utils.message(e,"error")}})}extractTagFromTx(e,i){const n=e.tags?e.tags:[];for(const s of n)if(s.name===i)return s.value;return null}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(_.gz),t.Y36(b.N),t.Y36(x.F),t.Y36(D.n),t.Y36(P.X),t.Y36(t.R0b))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-likes"]],viewQuery:function(e,i){if(1&e&&t.Gf(ge,5,t.SBq),2&e){let n;t.iGM(n=t.CRH())&&(i.moreResultsCard=n.first)}},decls:10,vars:8,consts:[[1,"post-list-container"],[4,"ngFor","ngForOf"],[1,"more-results-container"],["color","accent","diameter","32",4,"ngIf"],["class","no-results",4,"ngIf"],["matRipple","",1,"more-results-card","mat-elevation-z0",3,"click"],["moreResultsCard",""],[1,"more-results","text-center"],[1,"label-likes"],["aria-label","Likes","color","warn"],[3,"txId","fullMode"],["color","accent","diameter","32"],[1,"no-results"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.YNc(1,ue,6,3,"ng-container",1),t.qZA(),t.TgZ(2,"div",2),t.YNc(3,me,1,0,"mat-spinner",3),t.YNc(4,fe,3,3,"div",4),t.TgZ(5,"mat-card",5,6),t.NdJ("click",function(){return i.moreResults()}),t.TgZ(7,"mat-card-content",7),t._uU(8),t.ALo(9,"translate"),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("ngForOf",i.likes),t.xp6(2),t.Q6J("ngIf",i.loadingLikes),t.xp6(1),t.Q6J("ngIf",!i.likes.length&&!i.loadingLikes),t.xp6(1),t.Udp("visibility",!i.loadingLikes&&i.moreResultsAvailable?"visible":"hidden"),t.xp6(3),t.hij(" ",t.lcZ(9,6,"GENERAL.LABELS.SHOW_OLDER_RESULTS")," "))},dependencies:[g.sg,g.O5,Z.Hw,h.a8,h.dn,T.wG,v.Ou,O.i,J.X$],styles:[".no-results[_ngcontent-%COMP%]{padding:20px;text-align:center;font-style:italic}.likes-subtitle[_ngcontent-%COMP%]{padding:20px;margin:10px 0 0}.mat-spinner[_ngcontent-%COMP%]{margin:0 auto}.label-likes[_ngcontent-%COMP%]{padding:20px;margin:10px 0 0}.more-results-container[_ngcontent-%COMP%]{padding-top:20px}"]}),o})();var _e=p(3745);function be(o,a){1&o&&(t.TgZ(0,"div",6),t._uU(1," No results."),t.qZA())}function xe(o,a){1&o&&t._UZ(0,"app-post-card",7),2&o&&t.Q6J("post",a.$implicit)}function we(o,a){1&o&&t._UZ(0,"mat-spinner",8)}function ve(o,a){1&o&&(t.TgZ(0,"div",6),t._uU(1," There are no pending Stories! "),t.qZA())}function Ce(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-card",9),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.moreResults())}),t.TgZ(1,"mat-card-content",10),t._uU(2," Show older posts "),t.qZA()()}}let Pe=(()=>{class o{constructor(e,i,n,s,l){this.route=e,this._arweave=i,this._post=n,this._utils=s,this._profileResolver=l,this.posts=[],this.maxPosts=10,this.loadingPosts=!1,this._postSubscription=u.w0.EMPTY,this._nextResultsSubscription=u.w0.EMPTY,this.moreResultsAvailable=!0,this.addressList=[]}ngOnInit(){this.route.parent.data.subscribe(e=>{const i=e.profile;this.loadPosts(i.profile&&i.profile.address?[i.profile.address]:[i.address])})}ngOnDestroy(){this._postSubscription.unsubscribe(),this._nextResultsSubscription.unsubscribe()}loadPosts(e){this.loadingPosts=!0,this.posts=[],this._postSubscription=this._post.getPendingPosts(e).subscribe({next:i=>{(!i||!i.length)&&(this.moreResultsAvailable=!1),this.posts=i,this.loadingPosts=!1},error:i=>{this.loadingPosts=!1,this.moreResultsAvailable=!1,this._utils.message(i,"error")}})}moreResults(){this.loadingPosts=!0,console.log("next!"),this._nextResultsSubscription=this._post.next().subscribe({next:e=>{(!e||!e.length)&&(this.moreResultsAvailable=!1),this.posts=this.posts.concat(e),this.loadingPosts=!1},error:e=>{this.loadingPosts=!1,this._utils.message(e,"error")}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(_.gz),t.Y36(b.N),t.Y36(_e.q),t.Y36(x.F),t.Y36(M))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-pending"]],decls:7,vars:5,consts:[["class","no-results",4,"ngIf"],[1,"post-list-container"],[3,"post",4,"ngFor","ngForOf"],[1,"more-results-container"],["color","accent","diameter","32",4,"ngIf"],["class","more-results-card mat-elevation-z0","matRipple","",3,"click",4,"ngIf"],[1,"no-results"],[3,"post"],["color","accent","diameter","32"],["matRipple","",1,"more-results-card","mat-elevation-z0",3,"click"],[1,"more-results","text-center"]],template:function(e,i){1&e&&(t.YNc(0,be,2,0,"div",0),t.TgZ(1,"div",1),t.YNc(2,xe,1,1,"app-post-card",2),t.qZA(),t.TgZ(3,"div",3),t.YNc(4,we,1,0,"mat-spinner",4),t.YNc(5,ve,2,0,"div",0),t.YNc(6,Ce,3,0,"mat-card",5),t.qZA()),2&e&&(t.Q6J("ngIf",!i.posts),t.xp6(2),t.Q6J("ngForOf",i.posts),t.xp6(2),t.Q6J("ngIf",i.loadingPosts),t.xp6(1),t.Q6J("ngIf",!i.posts.length&&!i.loadingPosts),t.xp6(1),t.Q6J("ngIf",!i.loadingPosts&&i.moreResultsAvailable))},dependencies:[g.sg,g.O5,h.a8,h.dn,T.wG,v.Ou,O.i],styles:[".more-results[_ngcontent-%COMP%]{font-weight:700;font-style:italic}.more-results-card[_ngcontent-%COMP%]{cursor:pointer;border-radius:0;width:100%;margin-top:20px;height:50px}.more-results-container[_ngcontent-%COMP%]{padding-top:20px}.mat-spinner[_ngcontent-%COMP%]{margin:0 auto}.no-results[_ngcontent-%COMP%]{padding:20px;text-align:center;font-style:italic}"]}),o})();const Te=["moreResultsCard"];function Ze(o,a){if(1&o&&(t.TgZ(0,"div",8),t._UZ(1,"app-user-card",9),t.qZA()),2&o){const e=a.$implicit;t.xp6(1),t.Q6J("address",e)}}function Fe(o,a){1&o&&t._UZ(0,"mat-spinner",10)}function Oe(o,a){1&o&&(t.TgZ(0,"div",11),t._uU(1," There are no followers yet! "),t.qZA())}let Me=(()=>{class o{constructor(e,i,n,s,l,r,c){this.route=e,this._arweave=i,this._follow=n,this._utils=s,this._profileResolver=l,this._appSettings=r,this._ngZone=c,this.followers=new Set([]),this.maxFollowers=10,this.loadingFollowers=!1,this._followersSubscription=u.w0.EMPTY,this._nextResultsSubscription=u.w0.EMPTY,this.moreResultsAvailable=!0,this.addressList=[]}ngOnInit(){this.route.parent.data.subscribe(e=>{const i=e.profile;this.loadFollowers(i.profile&&i.profile.address?[i.profile.address]:[i.address])}),this._appSettings.scrollTopStream.subscribe(e=>{this._ngZone.run(()=>{const i=this.moreResultsCard.nativeElement.offsetTop-this.moreResultsCard.nativeElement.scrollTop;e>i-700&&i&&!this.loadingFollowers&&this.moreResultsAvailable&&this.moreResults()})})}ngOnDestroy(){this._followersSubscription.unsubscribe(),this._nextResultsSubscription.unsubscribe()}loadFollowers(e){this.loadingFollowers=!0,this.followers.clear(),this._followersSubscription=this._arweave.getNetworkInfo().pipe((0,w.w)(i=>this._follow.getFollowers(e,this.maxFollowers,i.height))).subscribe({next:i=>{(!i||!i.length)&&(this.moreResultsAvailable=!1),console.log(i);for(const n of i)this.followers.add(n.owner);this.loadingFollowers=!1},error:i=>{this.loadingFollowers=!1,this.moreResultsAvailable=!1,this._utils.message(i,"error")}})}moreResults(){this.loadingFollowers=!0,this._nextResultsSubscription=this._follow.next().subscribe({next:e=>{(!e||!e.length)&&(this.moreResultsAvailable=!1);for(const i of e)this.followers.add(i.owner);this.loadingFollowers=!1},error:e=>{this.loadingFollowers=!1,this._utils.message(e,"error")}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(_.gz),t.Y36(b.N),t.Y36(k.R),t.Y36(x.F),t.Y36(M),t.Y36(P.X),t.Y36(t.R0b))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-followers"]],viewQuery:function(e,i){if(1&e&&t.Gf(Te,5,t.SBq),2&e){let n;t.iGM(n=t.CRH())&&(i.moreResultsCard=n.first)}},decls:11,vars:5,consts:[[1,"followers-list-container"],["class","followers-list-col",4,"ngFor","ngForOf"],[1,"more-results-container","clear-both"],["color","accent","diameter","32",4,"ngIf"],["class","no-results",4,"ngIf"],["matRipple","",1,"more-results-card","mat-elevation-z0",3,"click"],["moreResultsCard",""],[1,"more-results","text-center"],[1,"followers-list-col"],[3,"address"],["color","accent","diameter","32"],[1,"no-results"]],template:function(e,i){1&e&&(t.TgZ(0,"h2"),t._uU(1,"Followers"),t.qZA(),t.TgZ(2,"div",0),t.YNc(3,Ze,2,1,"div",1),t.qZA(),t.TgZ(4,"div",2),t.YNc(5,Fe,1,0,"mat-spinner",3),t.YNc(6,Oe,2,0,"div",4),t.TgZ(7,"mat-card",5,6),t.NdJ("click",function(){return i.moreResults()}),t.TgZ(9,"mat-card-content",7),t._uU(10," Show more results "),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("ngForOf",i.followers),t.xp6(2),t.Q6J("ngIf",i.loadingFollowers),t.xp6(1),t.Q6J("ngIf",!i.followers.size&&!i.loadingFollowers),t.xp6(1),t.Udp("visibility",!i.loadingFollowers&&i.moreResultsAvailable?"visible":"hidden"))},dependencies:[g.sg,g.O5,h.a8,h.dn,T.wG,v.Ou,N.r],styles:[".more-results[_ngcontent-%COMP%]{font-weight:700;font-style:italic}.more-results-card[_ngcontent-%COMP%]{cursor:pointer;border-radius:0;width:100%;margin-top:20px;height:50px}.more-results-container[_ngcontent-%COMP%]{padding-top:20px}.mat-spinner[_ngcontent-%COMP%]{margin:0 auto}.no-results[_ngcontent-%COMP%]{padding:20px;text-align:center;font-style:italic}.followers-list-container[_ngcontent-%COMP%]{padding-top:2px}h2[_ngcontent-%COMP%]{padding:20px}.followers-list-col[_ngcontent-%COMP%]{float:left;width:100%}@media (min-width: 800px){.followers-list-col[_ngcontent-%COMP%]{float:left;width:50%}}"]}),o})();const ke=["moreResultsCard"];function Ae(o,a){if(1&o&&(t.TgZ(0,"div",8),t._UZ(1,"app-user-card",9),t.qZA()),2&o){const e=a.$implicit;t.xp6(1),t.Q6J("address",e.wallets[0])}}function Ie(o,a){1&o&&t._UZ(0,"mat-spinner",10)}function ye(o,a){1&o&&(t.TgZ(0,"div",11),t._uU(1," No results! "),t.qZA())}let Ue=(()=>{class o{constructor(e,i,n,s,l,r,c){this.route=e,this._arweave=i,this._follow=n,this._utils=s,this._profileResolver=l,this._appSettings=r,this._ngZone=c,this.following=[],this.maxFollowers=10,this.loadingFollowing=!1,this._followingSubscription=u.w0.EMPTY,this._nextResultsSubscription=u.w0.EMPTY,this.moreResultsAvailable=!0,this.addressList=[]}ngOnInit(){this.route.parent.data.subscribe(e=>{const i=e.profile;this.loadFollowing(i.profile&&i.profile.address?[i.profile.address]:[i.address])}),this._appSettings.scrollTopStream.subscribe(e=>{this._ngZone.run(()=>{const i=this.moreResultsCard.nativeElement.offsetTop-this.moreResultsCard.nativeElement.scrollTop;e>i-700&&i&&!this.loadingFollowing&&this.moreResultsAvailable&&this.moreResults()})})}ngOnDestroy(){this._followingSubscription.unsubscribe(),this._nextResultsSubscription.unsubscribe()}loadFollowing(e){this.loadingFollowing=!0,this.following=[],this._followingSubscription=this._arweave.getNetworkInfo().pipe((0,w.w)(i=>this._follow.getFollowing(e,this.maxFollowers,i.height))).subscribe({next:i=>{(!i||!i.length)&&(this.moreResultsAvailable=!1);for(const n of i)this.extractTagsFromTx(n);this.loadingFollowing=!1},error:i=>{this.loadingFollowing=!1,this.moreResultsAvailable=!1,this._utils.message(i,"error")}})}moreResults(){this.loadingFollowing=!0,this._nextResultsSubscription=this._follow.nextFollowing().subscribe({next:e=>{(!e||!e.length)&&(this.moreResultsAvailable=!1);for(const i of e)this.extractTagsFromTx(i);this.loadingFollowing=!1},error:e=>{this.loadingFollowing=!1,this._utils.message(e,"error")}})}extractTagsFromTx(e){const i=e&&e.tags?e.tags:[],n={username:"",wallets:[]};for(const s of i)"Wallet"===s.name?this._arweave.validateAddress(s.value)?n.wallets.push(s.value):console.error("Invalid wallet tag",s):"Username"===s.name&&(n.username=s.value.trim());(n.username||n.wallets.length)&&this.following.push(n)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(_.gz),t.Y36(b.N),t.Y36(k.R),t.Y36(x.F),t.Y36(M),t.Y36(P.X),t.Y36(t.R0b))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-following"]],viewQuery:function(e,i){if(1&e&&t.Gf(ke,5,t.SBq),2&e){let n;t.iGM(n=t.CRH())&&(i.moreResultsCard=n.first)}},decls:11,vars:5,consts:[[1,"following-list-container"],["class","following-list-col",4,"ngFor","ngForOf"],[1,"more-results-container","clear-both"],["color","accent","diameter","32",4,"ngIf"],["class","no-results",4,"ngIf"],["matRipple","",1,"more-results-card","mat-elevation-z0",3,"click"],["moreResultsCard",""],[1,"more-results","text-center"],[1,"following-list-col"],[3,"address"],["color","accent","diameter","32"],[1,"no-results"]],template:function(e,i){1&e&&(t.TgZ(0,"h2"),t._uU(1,"Following"),t.qZA(),t.TgZ(2,"div",0),t.YNc(3,Ae,2,1,"div",1),t.qZA(),t.TgZ(4,"div",2),t.YNc(5,Ie,1,0,"mat-spinner",3),t.YNc(6,ye,2,0,"div",4),t.TgZ(7,"mat-card",5,6),t.NdJ("click",function(){return i.moreResults()}),t.TgZ(9,"mat-card-content",7),t._uU(10," Show more results "),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("ngForOf",i.following),t.xp6(2),t.Q6J("ngIf",i.loadingFollowing),t.xp6(1),t.Q6J("ngIf",!i.following.length&&!i.loadingFollowing),t.xp6(1),t.Udp("visibility",!i.loadingFollowing&&i.moreResultsAvailable?"visible":"hidden"))},dependencies:[g.sg,g.O5,h.a8,h.dn,T.wG,v.Ou,N.r],styles:[".more-results[_ngcontent-%COMP%]{font-weight:700;font-style:italic}.more-results-card[_ngcontent-%COMP%]{cursor:pointer;border-radius:0;width:100%;margin-top:20px;height:50px}.more-results-container[_ngcontent-%COMP%]{padding-top:20px}.mat-spinner[_ngcontent-%COMP%]{margin:0 auto}.no-results[_ngcontent-%COMP%]{padding:20px;text-align:center;font-style:italic}.following-list-container[_ngcontent-%COMP%]{padding-top:2px}h2[_ngcontent-%COMP%]{padding:20px}.following-list-col[_ngcontent-%COMP%]{float:left;width:100%}@media (min-width: 800px){.following-list-col[_ngcontent-%COMP%]{float:left;width:50%}}"]}),o})();var E=p(4004),Re=p(2076),Se=p(6174);let Le=(()=>{class o{constructor(e,i,n){this._arweave=e,this._userAuth=i,this._appSettings=n,this._ardb=new Se.f(this._arweave.arweave)}uploadFile(){}getUserFiles(e,i=[],n,s){return this._ardb.searchTransactions(i,n,s,[{name:"Content-Type",values:e}]).pipe((0,E.U)(r=>r.map(d=>({id:d.id,owner:d.owner.address,blockId:d.block&&d.block.id?d.block.id:"",blockHeight:d.block&&d.block.height?d.block.height:0,dataSize:d.data?d.data.size:void 0,dataType:d.data?d.data.type:void 0,blockTimestamp:d.block&&d.block.timestamp?d.block.timestamp:void 0,tags:d.tags}))))}next(){return(0,Re.D)(this._ardb.next()).pipe((0,E.U)(e=>e&&e.length?e.map(n=>({id:n.id,owner:n.owner.address,blockId:n.block&&n.block.id?n.block.id:"",blockHeight:n.block&&n.block.height?n.block.height:0,dataSize:n.data?n.data.size:void 0,dataType:n.data?n.data.type:void 0,blockTimestamp:n.block&&n.block.timestamp?n.block.timestamp:void 0,tags:n.tags})):[]))}getFile(e=[],i){return this._ardb.searchOneTransaction(e,i).pipe((0,E.U)(n=>{if(!n)throw new Error("Tx not found!");return{id:n.id,owner:n.owner.address,blockId:n.block&&n.block.id?n.block.id:"",blockHeight:n.block&&n.block.height?n.block.height:0,dataSize:n.data?n.data.size:void 0,dataType:n.data?n.data.type:void 0,blockTimestamp:n.block&&n.block.timestamp?n.block.timestamp:void 0,tags:n.tags}}))}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(b.N),t.LFG(F.H),t.LFG(P.X))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const Ye=["moreResultsCard"];function De(o,a){1&o&&(t.TgZ(0,"small"),t._uU(1,"(Filter: Image)"),t.qZA())}function Ne(o,a){1&o&&t._UZ(0,"mat-spinner",18)}function Je(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",19),t.NdJ("click",function(){const s=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.close({id:s.id,type:l.data.type}))}),t.TgZ(1,"mat-card")(2,"div",20),t._UZ(3,"img",21),t.qZA(),t.TgZ(4,"app-arweave-address",22),t._uU(5,"Tx: "),t.qZA(),t.TgZ(6,"p",23)(7,"strong"),t._uU(8,"Created:"),t.qZA(),t._uU(9),t.qZA()()()}if(2&o){const e=a.$implicit,i=t.oxw(2);t.xp6(3),t.Q6J("src",i.getFileUrl(e.id),t.LSH),t.xp6(1),t.Q6J("address",e.id)("isAddress",!1),t.xp6(5),t.hij(" ",i.dateFormat(e.blockTimestamp),"")}}function Ee(o,a){1&o&&t._UZ(0,"mat-spinner",24)}function qe(o,a){1&o&&(t.TgZ(0,"div",25),t._uU(1," You have no files yet! "),t.qZA())}function Qe(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",9),t.YNc(1,Ne,1,0,"mat-spinner",10),t.YNc(2,Je,10,4,"div",11),t.TgZ(3,"div",12),t.YNc(4,Ee,1,0,"mat-spinner",13),t.YNc(5,qe,2,0,"div",14),t.TgZ(6,"mat-card",15,16),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.moreResults())}),t.TgZ(8,"mat-card-content",17),t._uU(9," Show more "),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.loadingFiles),t.xp6(1),t.Q6J("ngForOf",e.files),t.xp6(2),t.Q6J("ngIf",e.loadingMore),t.xp6(1),t.Q6J("ngIf",!e.files.length&&!e.loadingMore&&!e.loadingFiles),t.xp6(1),t.Udp("visibility",e.loadingMore||e.loadingFiles||!e.moreResultsAvailable?"hidden":"visible")}}let G=(()=>{class o{constructor(e,i,n,s,l,r){this._dialogRef=e,this.data=i,this._utils=n,this._fileExplorer=s,this._arweave=l,this._appSettings=r,this.files=[],this._loadingFilesSubscription=u.w0.EMPTY,this._nextResultsSubscription=u.w0.EMPTY,this.loadingFiles=!1,this.loadingMore=!1,this.moreResultsAvailable=!0}ngOnInit(){const e=this._appSettings.supportedFiles[this.data.type];this.loadingFiles=!0,this._loadingFilesSubscription=this._fileExplorer.getUserFiles(e,this.data.address,20).subscribe({next:n=>{(!n||!n.length)&&(this.moreResultsAvailable=!1),this.files=n,this.loadingFiles=!1},error:n=>{this._utils.message(n,"error"),this.loadingFiles=!1}})}close(e=null){this._dialogRef.close(e)}moreResults(){this.loadingMore=!0,this._nextResultsSubscription=this._fileExplorer.next().subscribe({next:e=>{(!e||!e.length)&&(this.moreResultsAvailable=!1),this.files.push(...e),this.loadingMore=!1},error:e=>{this.loadingMore=!1,this._utils.message(e,"error")}})}ngOnDestroy(){this._loadingFilesSubscription.unsubscribe(),this._nextResultsSubscription.unsubscribe()}hasOwnProperty(e,i){return Object.prototype.hasOwnProperty.call(e,i)}ellipsis(e){return this._utils.ellipsis(e)}getFileUrl(e){return`${this._arweave.baseURL}${e}`}dateFormat(e){return this._utils.dateFormat(e||"")}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(m.so),t.Y36(m.WI),t.Y36(x.F),t.Y36(Le),t.Y36(b.N),t.Y36(P.X))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-file-manager-dialog"]],viewQuery:function(e,i){if(1&e&&t.Gf(Ye,5,t.SBq),2&e){let n;t.iGM(n=t.CRH())&&(i.moreResultsCard=n.first)}},decls:13,vars:3,consts:[["mat-dialog-title","",1,"title-text"],[4,"ngIf"],[1,"title-buttons"],["mat-icon-button","","aria-label","Close window",3,"click"],[1,"clear-both"],[1,"content","border-right-special"],[1,"user-address","text-right"],[3,"address"],["class","images-grid",4,"ngIf"],[1,"images-grid"],["class","loader","color","accent","mode","indeterminate",4,"ngIf"],["class","mat-card-container fadeIn",3,"click",4,"ngFor","ngForOf"],[1,"more-results-container","clear-both"],["class","loader","color","accent","diameter","32",4,"ngIf"],["class","no-results",4,"ngIf"],["matRipple","",1,"more-results-card","mat-elevation-z0",3,"click"],["moreResultsCard",""],[1,"more-results","text-center"],["color","accent","mode","indeterminate",1,"loader"],[1,"mat-card-container","fadeIn",3,"click"],[1,"card-img-container"],["alt","Img",3,"src"],[3,"address","isAddress"],[1,"ellipsis","nowrap"],["color","accent","diameter","32",1,"loader"],[1,"no-results"]],template:function(e,i){1&e&&(t.TgZ(0,"h2",0),t._uU(1," File Manager "),t.YNc(2,De,2,0,"small",1),t.qZA(),t.TgZ(3,"div",2)(4,"button",3),t.NdJ("click",function(){return i.close(null)}),t.TgZ(5,"mat-icon"),t._uU(6,"close"),t.qZA()()(),t._UZ(7,"div",4),t.TgZ(8,"mat-dialog-content",5)(9,"div",6)(10,"app-arweave-address",7),t._uU(11,"User: "),t.qZA()(),t.YNc(12,Qe,10,6,"div",8),t.qZA()),2&e&&(t.xp6(2),t.Q6J("ngIf","image"===i.data.type),t.xp6(8),t.Q6J("address",i.data.address),t.xp6(2),t.Q6J("ngIf","image"===i.data.type))},dependencies:[g.sg,g.O5,Z.Hw,h.a8,h.dn,C.lW,T.wG,v.Ou,m.uh,m.xY,L.N],styles:[".content[_ngcontent-%COMP%]{padding:20px;min-height:428px;max-width:880px;min-width:200px;overflow-y:auto}.title-text[_ngcontent-%COMP%]{float:left;width:70%;font-weight:700}.title-buttons[_ngcontent-%COMP%]{float:left;width:30%;text-align:right;margin-top:-6px}.mat-dialog-container[_ngcontent-%COMP%]{padding:0}.mat-dialog-content[_ngcontent-%COMP%]{border-top:1px solid;display:flex;flex-direction:column}.title-text[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px}.user-address[_ngcontent-%COMP%]{height:24px}.user-address[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-weight:400}.user-address[_ngcontent-%COMP%]   app-arweave-address[_ngcontent-%COMP%]{font-size:12px;justify-content:right}.images-grid[_ngcontent-%COMP%]{width:100%;flex:1}.images-grid[_ngcontent-%COMP%]   .mat-card-container[_ngcontent-%COMP%]{float:left;width:50%;padding:10px;font-size:12px}.images-grid[_ngcontent-%COMP%]   .mat-card[_ngcontent-%COMP%]{cursor:pointer}.loader[_ngcontent-%COMP%]{margin:60px auto 0}.more-results[_ngcontent-%COMP%]{font-weight:700;font-style:italic}.more-results-card[_ngcontent-%COMP%]{cursor:pointer;border-radius:0;width:100%;margin-top:20px;height:50px}.more-results-container[_ngcontent-%COMP%]{padding-top:20px}.no-results[_ngcontent-%COMP%]{padding:20px;text-align:center;font-style:italic}.card-img-container[_ngcontent-%COMP%]{width:100%;height:100px;margin-bottom:6px}.card-img-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}@media (min-width: 420px){.content[_ngcontent-%COMP%]{max-width:880px;min-width:400px}}@media (min-width: 820px){.content[_ngcontent-%COMP%]{max-width:880px;min-width:800px}.images-grid[_ngcontent-%COMP%]   .mat-card-container[_ngcontent-%COMP%]{width:25%}.card-img-container[_ngcontent-%COMP%]{height:140px}}"]}),o})();var ze=p(9751),He=p(1481);const Be=["fileInput"];function je(o,a){1&o&&(t.TgZ(0,"small"),t._uU(1,"(Filter: Image)"),t.qZA())}function Ge(o,a){1&o&&(t.TgZ(0,"span"),t._uU(1,"All"),t.qZA())}function Ve(o,a){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.xp6(1),t.hij(" ",e," ")}}function Ke(o,a){if(1&o&&(t.TgZ(0,"div"),t.YNc(1,Ve,2,1,"span",18),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.supportedFiles[e.data.type])}}function $e(o,a){if(1&o&&(t.TgZ(0,"p",19)(1,"mat-icon",20),t._uU(2,"warning"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(4),t.Oqu(e.errorMessage01)}}const Xe=function(o){return{"file-upload-zone-active":o}};function We(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-dialog-content",7),t.NdJ("drop",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.dropFile(n,s.data.type))})("dragover",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.dragOverFile(n))})("dragenter",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.dragEnterFile(n))})("dragleave",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.dragLeaveFile(n))}),t.TgZ(1,"div",8)(2,"div",9)(3,"input",10,11),t.NdJ("change",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.readFileFromInput(n,s.data.type))}),t.qZA()(),t.TgZ(5,"button",12),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.openFileExplorer())}),t.TgZ(6,"mat-icon"),t._uU(7,"upload"),t.qZA()(),t.TgZ(8,"p",13)(9,"strong"),t._uU(10,"Drag and drop your files to upload."),t.qZA()(),t.TgZ(11,"div",14),t._uU(12," Supported files: "),t.YNc(13,Ge,2,0,"span",1),t.YNc(14,Ke,2,1,"div",1),t.qZA(),t.TgZ(15,"p",13)(16,"button",15),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.openFileExplorer())}),t._uU(17," SELECT FILES "),t.qZA()(),t.YNc(18,$e,5,1,"p",16),t.qZA(),t.TgZ(19,"p",17),t._uU(20," You are about to upload a file to the Arweave blockchain. Make sure you don't infringe other people's copyrights, privacy rights or any kind of legal right. "),t.qZA(),t.TgZ(21,"p",17),t._uU(22," Using this tool implies that you agree to PublicSquare's Terms of Service and Community Guidelines. "),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngClass",t.VKq(5,Xe,e.dragFileActive)),t.xp6(2),t.Q6J("accept",e.getSupportedFilesAsStr(e.data.type)),t.xp6(10),t.Q6J("ngIf",e.data.type&&!e.hasOwnProperty(e.supportedFiles,e.data.type)),t.xp6(1),t.Q6J("ngIf",e.data.type&&e.hasOwnProperty(e.supportedFiles,e.data.type)),t.xp6(4),t.Q6J("ngIf",e.errorMessage01)}}function ti(o,a){if(1&o&&(t.ynx(0),t._UZ(1,"img",26),t.BQk()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.file.buffer,t.LSH)}}function ei(o,a){if(1&o&&(t.TgZ(0,"p",22)(1,"mat-checkbox",27),t._uU(2," Upload file for FREE (Dispatch method) "),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("formControl",e.useDispatch)}}function ii(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-dialog-content",21)(1,"h3"),t._uU(2,"File preview"),t.qZA(),t.YNc(3,ti,2,1,"ng-container",1),t.TgZ(4,"div",22)(5,"p"),t._uU(6),t.qZA(),t.YNc(7,ei,3,1,"p",23),t.TgZ(8,"button",24),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.upload(n.data.type))}),t._uU(9,"Upload now"),t.qZA(),t.TgZ(10,"button",25),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.cancel())}),t._uU(11,"Cancel"),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(3),t.Q6J("ngIf","image"===e.data.type),t.xp6(3),t.hij(" Size: ",e.file.size," bytes "),t.xp6(1),t.Q6J("ngIf",e.file.size<=e.dataSizeLimitDispatch)}}function ni(o,a){if(1&o&&(t.TgZ(0,"p",22),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.AsE("",e.progressObj.uploaded,"/",e.progressObj.total,"")}}function oi(o,a){if(1&o&&(t.TgZ(0,"mat-dialog-content",21),t._UZ(1,"mat-progress-bar",28)(2,"mat-spinner",29),t.TgZ(3,"p",22),t._uU(4),t.qZA(),t.YNc(5,ni,2,2,"p",23),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("value",e.toPercentage(e.progressObj.uploaded,e.progressObj.total)),t.xp6(1),t.Q6J("diameter",40),t.xp6(2),t.Oqu(e.progressObj.completed),t.xp6(1),t.Q6J("ngIf",e.progressObj.uploaded)}}let V=(()=>{class o{constructor(e,i,n,s,l,r){this._dialogRef=e,this.data=i,this._arweave=n,this._userAuth=s,this._appSettings=l,this.domSanitizer=r,this.errorMessage01="",this.dragFileActive=!1,this.enterCounter=0,this.file={name:"",size:0,type:"",buffer:null,file:null},this.readFileSubscription=u.w0.EMPTY,this.uploadingFile=!1,this.filePreview=!1,this.progressObj={completed:"0%",uploaded:"",total:""},this.supportedFiles={},this.dataSizeLimitDispatch=0,this.useDispatch=new f.p4(!1),this.supportedFiles=this._appSettings.supportedFiles,this.dataSizeLimitDispatch=this._arweave.dataSizeLimitDispatch}ngOnInit(){}close(e=null){this._dialogRef.close(e)}dropFile(e,i){e.preventDefault(),this.errorMessage01="";try{const s=e.dataTransfer;let l=null;if(s.items){if(s.items.length<=0)throw new Error("Empty file list");if(s.items.length>1)throw new Error("Please upload 1 file at a time.");const r=s.items[0];if("file"!==r.kind)throw new Error("Only files allowed!");l=r.getAsFile()}else{if(s.files.length<=0)throw new Error("Empty file list");if(s.files.length>1)throw new Error("Please upload 1 file at a time.");l=s.files[0]}this.preview(l,i)}catch(n){console.error(n),this.errorMessage01=`${n}`}this.cleanDragData(e)}dragOverFile(e){e.preventDefault()}cleanDragData(e){this.enterCounter=0,this.dragFileActive=!1;const n=e.dataTransfer;n.items?n.items.clear():n.clearData()}ngOnDestroy(){this.readFileSubscription.unsubscribe()}dragEnterFile(e){this.enterCounter++,this.dragFileActive=!0}dragLeaveFile(e){this.enterCounter--,this.enterCounter<=0&&(this.dragFileActive=!1,this.enterCounter=0)}hasOwnProperty(e,i){return Object.prototype.hasOwnProperty.call(e,i)}openFileExplorer(){this.fileInput.nativeElement.click()}fileToData(e,i,n=!1){var s=this;return new ze.y(r=>{try{this.validateFileType(i,e.type);const c=new FileReader;c.onload=(0,H.Z)(function*(){try{const d=c.result.toString();s.file.name=e.name,s.file.size=e.size,s.file.type=e.type,s.file.buffer=s.domSanitizer.bypassSecurityTrustUrl(d),s.file.file=e,r.next(n?c.result:d),r.complete()}catch{throw Error("Error loading file")}}),c.onerror=()=>{throw Error("Error reading file")},n?c.readAsArrayBuffer(e):c.readAsDataURL(e)}catch(c){r.error(c)}})}readFileFromInput(e,i){const n=e.target,s=n.files;this.preview(n&&s.length?s[0]:null,i)}getSupportedFilesAsStr(e){return this._appSettings.supportedFiles[e].join(",")}validateFileType(e,i){if(!(e in this._appSettings.supportedFiles))throw new Error(`${e} not supported`);if(this._appSettings.supportedFiles[e].indexOf(i)<0)throw new Error(`${i} is not of type ${e}`)}preview(e,i){this.errorMessage01="",this.uploadingFile=!1,this.filePreview=!0,this.readFileSubscription=this.fileToData(e,i).subscribe({next:n=>{},error:n=>{this.errorMessage01=n&&Object.prototype.hasOwnProperty.call(n,"message")?`${n.message}`:`${n}`,this.filePreview=!1,this.useDispatch.setValue(!1)}})}upload(e){this.errorMessage01="",this.filePreview=!1,this.uploadingFile=!0,this.progressObj={completed:"0%",uploaded:"",total:""};const i=this.file.file;this.readFileSubscription=this.fileToData(i,e,!0).pipe((0,w.w)(n=>{const s=this._userAuth.getPrivateKey();let c=!0;return i.size<=this.dataSizeLimitDispatch&&(c=!this.useDispatch.value),this._arweave.uploadFileToArweave(n,i.type,s,[],this._userAuth.loginMethod,c,this.progressObj)})).subscribe({next:n=>{this.close({id:n.id,type:e})},error:n=>{this.errorMessage01=n&&Object.prototype.hasOwnProperty.call(n,"message")?`${n.message}`:`${n}`,this.uploadingFile=!1,this.useDispatch.setValue(!1)}})}toPercentage(e,i){return 100*+e/+i}cancel(){this.errorMessage01="",this.filePreview=!1,this.uploadingFile=!1,this.useDispatch.setValue(!1),this.file={name:"",size:0,type:"",buffer:null,file:null}}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(m.so),t.Y36(m.WI),t.Y36(b.N),t.Y36(F.H),t.Y36(P.X),t.Y36(He.H7))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-upload-file-dialog"]],viewQuery:function(e,i){if(1&e&&t.Gf(Be,5),2&e){let n;t.iGM(n=t.CRH())&&(i.fileInput=n.first)}},decls:11,vars:4,consts:[["mat-dialog-title","",1,"title-text"],[4,"ngIf"],[1,"title-buttons"],["mat-icon-button","","aria-label","Close window",3,"click"],[1,"clear-both"],["class","content border-right-special",3,"drop","dragover","dragenter","dragleave",4,"ngIf"],["class","content border-right-special text-center",4,"ngIf"],[1,"content","border-right-special",3,"drop","dragover","dragenter","dragleave"],[1,"file-upload-zone",3,"ngClass"],[2,"visibility","hidden"],["type","file",3,"accept","change"],["fileInput",""],["cdkFocusInitial","","mat-fab","","color","primary","aria-label","Upload file",1,"btn-upload",3,"click"],[1,"text-secondary-fup"],[1,"text-secondary-fup","supported-text"],["mat-flat-button","","color","accent",1,"btn-upload-txt",3,"click"],["class","text-secondary-fup fup-error",4,"ngIf"],[1,"footer-text"],[4,"ngFor","ngForOf"],[1,"text-secondary-fup","fup-error"],["color","warn","aria-hidden","false","aria-label","Error"],[1,"content","border-right-special","text-center"],[1,"text-center"],["class","text-center",4,"ngIf"],["mat-button","",3,"click"],["mat-button","","color","warn",1,"cancel-btn",3,"click"],[3,"src"],[1,"dispatch-chk",3,"formControl"],["color","accent","mode","determinate",3,"value"],["color","accent",3,"diameter"]],template:function(e,i){1&e&&(t.TgZ(0,"h2",0),t._uU(1," Upload files "),t.YNc(2,je,2,0,"small",1),t.qZA(),t.TgZ(3,"div",2)(4,"button",3),t.NdJ("click",function(){return i.close()}),t.TgZ(5,"mat-icon"),t._uU(6,"close"),t.qZA()()(),t._UZ(7,"div",4),t.YNc(8,We,23,7,"mat-dialog-content",5),t.YNc(9,ii,12,3,"mat-dialog-content",6),t.YNc(10,oi,6,4,"mat-dialog-content",6)),2&e&&(t.xp6(2),t.Q6J("ngIf","image"===i.data.type),t.xp6(6),t.Q6J("ngIf",!i.uploadingFile&&!i.filePreview),t.xp6(1),t.Q6J("ngIf",i.filePreview),t.xp6(1),t.Q6J("ngIf",i.uploadingFile))},dependencies:[g.mk,g.sg,g.O5,U.oG,R.pW,Z.Hw,f.JJ,f.oH,C.lW,v.Ou,m.uh,m.xY],styles:[".content[_ngcontent-%COMP%]{padding:20px;min-height:428px;max-width:880px;min-width:200px}.content[_ngcontent-%COMP%]   .mat-spinner[_ngcontent-%COMP%]{margin:0 auto}.title-text[_ngcontent-%COMP%]{float:left;width:70%;font-weight:700}.title-text[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px}.title-buttons[_ngcontent-%COMP%]{float:left;width:30%;text-align:right;margin-top:-6px}.footer-text[_ngcontent-%COMP%]{font-size:10px;text-align:center;margin-bottom:6px}.mat-dialog-container[_ngcontent-%COMP%]{padding:0}.mat-dialog-content[_ngcontent-%COMP%]{border-top:1px solid}.file-upload-zone[_ngcontent-%COMP%]{height:240px;text-align:center;padding:10px;border:2px dashed;border-color:transparent;margin-bottom:32px}.file-upload-zone-active[_ngcontent-%COMP%]{border-color:#09f}.btn-upload[_ngcontent-%COMP%]{margin-top:0;margin-bottom:12px}.btn-upload.mat-fab[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:52px!important;width:52px!important;height:52px!important;line-height:52px}.btn-upload.mat-fab[_ngcontent-%COMP%]{width:98px;height:98px}.text-secondary-fup[_ngcontent-%COMP%]{margin-top:6px;font-size:12px}.fup-error[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:6px}@media (min-width: 600px){.file-upload-zone[_ngcontent-%COMP%]{min-height:300px;padding:40px;margin-bottom:12px}.content[_ngcontent-%COMP%]{min-height:438px;min-width:400px}}@media (min-width: 800px){.file-upload-zone[_ngcontent-%COMP%]{min-height:330px;padding:40px;margin-bottom:12px}.btn-upload.mat-fab[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:72px!important;width:72px!important;height:72px!important;line-height:72px}.btn-upload.mat-fab[_ngcontent-%COMP%]{width:118px;height:118px}}.supported-text[_ngcontent-%COMP%]{font-size:10px}.supported-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:6px}.btn-upload-txt[_ngcontent-%COMP%]{margin-top:12px}.image-preview[_ngcontent-%COMP%]{min-width:340px;max-width:400px;height:320px;text-align:center}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.cancel-btn[_ngcontent-%COMP%]{margin-left:32px}.content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   audio[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{max-width:80%;margin:0 auto}.dispatch-chk[_ngcontent-%COMP%]{font-size:12px;margin-top:12px;margin-bottom:20px}"]}),o})();var q=p(9549),si=p(4144);function ai(o,a){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"*Please write your handle name."),t.qZA())}function ri(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",2)(2,"h4"),t._uU(3,"Profile image"),t.qZA(),t._UZ(4,"img",3),t.TgZ(5,"div",4)(6,"button",5),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.uploadFile("image"))}),t.TgZ(7,"mat-icon",6),t._uU(8,"image"),t.qZA(),t._uU(9," Upload file"),t.qZA(),t.TgZ(10,"button",5),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.fileManager("image"))}),t.TgZ(11,"mat-icon"),t._uU(12,"perm_media"),t.qZA(),t._uU(13," File manager"),t.qZA(),t.TgZ(14,"button",7),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.removeProfileImage())}),t.TgZ(15,"mat-icon"),t._uU(16,"delete"),t.qZA(),t._uU(17," Remove image"),t.qZA()()(),t.TgZ(18,"div",8)(19,"h4"),t._uU(20,"Profile info"),t.qZA(),t.TgZ(21,"p",9),t._uU(22,"Update/create your "),t.TgZ(23,"a",10),t._uU(24,"Arweave Account"),t.qZA(),t._uU(25," profile."),t.qZA(),t.TgZ(26,"form",11),t.NdJ("ngSubmit",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.submitProfile())}),t.TgZ(27,"div",12)(28,"app-arweave-address",13),t._uU(29," Wallet: "),t.qZA()(),t.TgZ(30,"mat-form-field",14)(31,"mat-label"),t._uU(32,"Handle"),t.qZA(),t._UZ(33,"input",15),t.YNc(34,ai,2,0,"mat-error",0),t.qZA(),t.TgZ(35,"mat-form-field",14)(36,"mat-label"),t._uU(37,"Name"),t.qZA(),t._UZ(38,"input",16),t.qZA(),t.TgZ(39,"mat-form-field",14)(40,"mat-label"),t._uU(41,"Bio"),t.qZA(),t._UZ(42,"textarea",17),t.qZA(),t.TgZ(43,"h3",18),t._uU(44,"Links"),t.qZA(),t.TgZ(45,"mat-form-field",14)(46,"mat-label"),t._uU(47,"Twitter"),t.qZA(),t._UZ(48,"input",19),t.qZA(),t.TgZ(49,"mat-form-field",14)(50,"mat-label"),t._uU(51,"YouTube"),t.qZA(),t._UZ(52,"input",20),t.qZA(),t.TgZ(53,"mat-form-field",14)(54,"mat-label"),t._uU(55,"Github"),t.qZA(),t._UZ(56,"input",21),t.qZA(),t.TgZ(57,"mat-form-field",14)(58,"mat-label"),t._uU(59,"Instagram"),t.qZA(),t._UZ(60,"input",22),t.qZA(),t.TgZ(61,"mat-form-field",14)(62,"mat-label"),t._uU(63,"Facebook"),t.qZA(),t._UZ(64,"input",23),t.qZA(),t.TgZ(65,"mat-form-field",14)(66,"mat-label"),t._uU(67,"Discord"),t.qZA(),t._UZ(68,"input",24),t.qZA(),t.TgZ(69,"div",25)(70,"button",26)(71,"mat-icon"),t._uU(72,"save"),t.qZA(),t.TgZ(73,"span"),t._uU(74,"Save profile"),t.qZA()()()()(),t.BQk()}if(2&o){const e=t.oxw();t.xp6(4),t.Q6J("src",e.profileImage,t.LSH),t.xp6(2),t.Q6J("disabled",e.loadingSavingProfile||e.validatingUsername),t.xp6(4),t.Q6J("disabled",e.loadingSavingProfile||e.validatingUsername),t.xp6(4),t.Q6J("disabled",e.loadingSavingProfile||e.validatingUsername),t.xp6(12),t.Q6J("formGroup",e.profileFrm),t.xp6(2),t.Q6J("address",e.mainAddress),t.xp6(6),t.Q6J("ngIf",e.username.invalid),t.xp6(36),t.Q6J("disabled",!e.profileFrm.valid||e.loadingSavingProfile||e.validatingUsername)}}function li(o,a){1&o&&(t.TgZ(0,"div",27),t._uU(1," Please login first.\n"),t.qZA())}function ci(o,a){1&o&&(t.TgZ(0,"div",27),t._uU(1," You don't have enough privileges for editing this profile.\n"),t.qZA())}function pi(o,a){1&o&&(t.TgZ(0,"div",27),t._uU(1," Login method not supported. Please try using Arweave.app wallet or ArConnect.\n"),t.qZA())}let di=(()=>{class o{constructor(e,i,n,s,l,r,c,d){this._userSettings=e,this._auth=i,this._dialog=n,this._arweave=s,this._appSettings=l,this._profile=r,this._utils=c,this._route=d,this.mainAddress="",this.loginMethod="",this.addressFromRoute="",this.validatingUsername=!1,this.errorMsgUsername="",this.profile=void 0,this._loadingProfileSubscription=u.w0.EMPTY,this.profileImage="assets/images/blank-profile.jpg",this.profileImageTX="",this.loadingSavingProfile=!1,this._savingProfileSubscription=u.w0.EMPTY,this.profileFrm=new f.cw({username:new f.NI("",{validators:[f.kI.required]}),name:new f.NI(""),bio:new f.NI(""),twitter:new f.NI(""),github:new f.NI(""),instagram:new f.NI(""),facebook:new f.NI(""),youtube:new f.NI(""),discord:new f.NI("")}),this.defaultProfileImage="assets/images/blank-profile.jpg"}get username(){return this.profileFrm.get("username")}get name(){return this.profileFrm.get("name")}get bio(){return this.profileFrm.get("bio")}get twitter(){return this.profileFrm.get("twitter")}get facebook(){return this.profileFrm.get("facebook")}get github(){return this.profileFrm.get("github")}get instagram(){return this.profileFrm.get("instagram")}get youtube(){return this.profileFrm.get("youtube")}get discord(){return this.profileFrm.get("discord")}ngOnInit(){this._appSettings.scrollTo("ww-mat-sidenav-main-content",400),this.mainAddress=this._auth.getMainAddressSnapshot(),this.loginMethod=this._auth.loginMethod,this._route.parent.data.subscribe(e=>{const i=e&&Object.prototype.hasOwnProperty.call(e,"profile")?e.profile:{},n=i&&i.hasOwnProperty("address")?i.address:"",s=i&&i.hasOwnProperty("profile")&&i.profile?i.profile:{};this.addressFromRoute=n,this.profile=s,this.fillProfileFrm(s)}),this._auth.account$.subscribe(e=>{this.mainAddress=e,this.loginMethod=this._auth.loginMethod,e?this.loadProfile(this.mainAddress):this.resetFrmValues()})}isValidUser(){let e=!1;const i=this.profile&&this.profile.address?[this.profile.address]:[];return((this.addressFromRoute===(this.profile&&this.profile.username?this.profile.username:"")||i.findIndex(s=>s===this.addressFromRoute)>=0)&&i.findIndex(s=>s===this.mainAddress)>=0||this.addressFromRoute===this.mainAddress)&&(e=!0),e}ngOnDestroy(){this._loadingProfileSubscription.unsubscribe(),this._savingProfileSubscription.unsubscribe()}fileManager(e){const i=this._userSettings.getDefaultLang(),n=this._userSettings.getLangObject(i);this._dialog.open(G,{restoreFocus:!1,autoFocus:!1,disableClose:!0,data:{type:e,address:this.mainAddress},direction:n&&"LTR"===n.writing_system?"ltr":"rtl",width:"800px"}).afterClosed().subscribe(r=>{if(r){const c={id:r.id,type:r.type,content:""};this.profileImage=this.getProfileImageUrl(c.id),this.profileImageTX=c.id}})}uploadFile(e){const i=this._userSettings.getDefaultLang(),n=this._userSettings.getLangObject(i);this._dialog.open(V,{restoreFocus:!1,autoFocus:!0,disableClose:!0,data:{type:e,address:this.mainAddress},direction:n&&"LTR"===n.writing_system?"ltr":"rtl",width:"800px"}).afterClosed().subscribe(r=>{if(r){const c={id:r.id,type:r.type,content:""};this.profileImage=this.getProfileImageUrl(c.id),this.profileImageTX=c.id}})}getProfileImageUrl(e){let i=this._arweave.getImageUrl(e);return i||(i="assets/images/blank-profile.jpg"),i}removeProfileImage(){this.profileImage="assets/images/blank-profile.jpg",this.profileImageTX=""}resetFrmValues(){this.removeProfileImage(),this.username.enable(),this.username.setValue(""),this.name.setValue(""),this.bio.setValue(""),this.twitter.setValue(""),this.facebook.setValue(""),this.github.setValue(""),this.instagram.setValue(""),this.youtube.setValue(""),this.discord.setValue("")}loadProfile(e){this._loadingProfileSubscription=this._profile.getProfileByAddress(e).subscribe({next:i=>{this.fillProfileFrm(i)},error:i=>{console.error(i)}})}submitProfile(){this.loadingSavingProfile=!0,this._auth.getPrivateKey();const n={handleName:this.profile&&this.profile.handleName?this.profile.handleName:"",avatar:this.profile&&this.profile.avatar?this.profile.avatar:"",avatarURL:"",banner:this.profile&&this.profile.banner?this.profile.banner:"",bannerURL:"",name:this.profile&&this.profile.name?this.profile.name:"",bio:this.profile&&this.profile.bio?this.profile.bio:"",email:this.profile&&this.profile.email?this.profile.email:"",links:this.profile&&this.profile.links?JSON.parse(JSON.stringify(this.profile.links)):{},wallets:this.profile&&this.profile.wallets?JSON.parse(JSON.stringify(this.profile.wallets)):{}};this.profileImageTX.trim()&&(n.avatar=`ar://${this.profileImageTX.trim()}`),this.username.value.trim()&&(n.handleName=`${this.username.value.trim()}`),this.name.value.trim()&&(n.name=`${this.name.value.trim()}`),this.bio.value.trim()&&(n.bio=`${this.bio.value.trim()}`),this.twitter.value.trim()&&(n.links.twitter=`${this.twitter.value.trim()}`),this.youtube.value.trim()&&(n.links.youtube=`${this.youtube.value.trim()}`),this.github.value.trim()&&(n.links.github=`${this.github.value.trim()}`),this.instagram.value.trim()&&(n.links.instagram=`${this.instagram.value.trim()}`),this.facebook.value.trim()&&(n.links.facebook=`${this.facebook.value.trim()}`),this.discord.value.trim()&&(n.links.discord=`${this.discord.value.trim()}`),this._savingProfileSubscription=this._profile.updateProfile(n).subscribe({next:s=>{s&&s.id&&this._utils.message(`Success! Tx id: ${s.id}`,"success"),this.loadingSavingProfile=!1},error:s=>{console.error("OnSubmit",s),this._utils.message("Error!","error"),this.loadingSavingProfile=!1}})}fillProfileFrm(e){if(this.resetFrmValues(),e){const i=e.avatarURL?e.avatarURL.trim():this.defaultProfileImage,n=e.handleName?e.handleName.trim():"",s=e.name?e.name.trim():"",l=e.bio?e.bio.trim():"",c=e.links?e.links:{},d=c&&Object.prototype.hasOwnProperty.call(c,"twitter")?c.twitter.trim():"",y=c&&Object.prototype.hasOwnProperty.call(c,"facebook")?c.facebook.trim():"",Q=c&&Object.prototype.hasOwnProperty.call(c,"github")?c.github.trim():"",Fi=c&&Object.prototype.hasOwnProperty.call(c,"instagram")?c.instagram.trim():"",Oi=c&&Object.prototype.hasOwnProperty.call(c,"youtube")?c.youtube.trim():"",Mi=c&&Object.prototype.hasOwnProperty.call(c,"discord")?c.discord.trim():"";this.profileImage=i,this.username.setValue(n),this.name.setValue(s),this.bio.setValue(l),this.twitter.setValue(d),this.facebook.setValue(y),this.github.setValue(Q),this.instagram.setValue(Fi),this.youtube.setValue(Oi),this.discord.setValue(Mi)}}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A.s),t.Y36(F.H),t.Y36(m.uw),t.Y36(b.N),t.Y36(P.X),t.Y36(I.H),t.Y36(x.F),t.Y36(_.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-edit-profile"]],decls:6,vars:4,consts:[[4,"ngIf"],["class","profile-container",4,"ngIf"],[1,"profile-image"],["mat-card-avatar","",1,"avatar","border-same-as-background","mat-elevation-z2",3,"src"],[1,"profile-image-actions"],["mat-stroked-button","","color","accent","type","button",3,"disabled","click"],[1,"material-icons-outlined"],["mat-stroked-button","","color","warn","type","button",3,"disabled","click"],[1,"profile-form"],[1,"instructions"],["target","_blank","href","https://account.metaweave.xyz/"],[3,"formGroup","ngSubmit"],[1,"addresses-container"],[1,"main-address",3,"address"],["appearance","outline","color","accent",1,"profile-field"],["matInput","","placeholder","","autocomplete","off","formControlName","username"],["matInput","","placeholder","","value","","autocomplete","off","formControlName","name"],["rows","5","matInput","","placeholder","","autocomplete","off","formControlName","bio"],[1,"subtitle"],["matInput","","placeholder","Your Twitter username","value","","autocomplete","off","formControlName","twitter"],["matInput","","placeholder","Your YouTube username","value","","autocomplete","off","formControlName","youtube"],["matInput","","placeholder","Your Github username","value","","autocomplete","off","formControlName","github"],["matInput","","placeholder","Your Instagram username","value","","autocomplete","off","formControlName","instagram"],["matInput","","placeholder","Your Facebook username","value","","autocomplete","off","formControlName","facebook"],["matInput","","placeholder","Your Discord handle","value","","autocomplete","off","formControlName","discord"],[1,"text-right","action-panel"],["color","accent","mat-flat-button","",3,"disabled"],[1,"profile-container"]],template:function(e,i){1&e&&(t.TgZ(0,"h2"),t._uU(1,"Edit profile"),t.qZA(),t.YNc(2,ri,75,8,"ng-container",0),t.YNc(3,li,2,0,"div",1),t.YNc(4,ci,2,0,"div",1),t.YNc(5,pi,2,0,"div",1)),2&e&&(t.xp6(2),t.Q6J("ngIf",i.mainAddress&&i.isValidUser()&&"pkFile"!==i.loginMethod),t.xp6(1),t.Q6J("ngIf",!i.mainAddress),t.xp6(1),t.Q6J("ngIf",!i.isValidUser()&&i.mainAddress),t.xp6(1),t.Q6J("ngIf","pkFile"===i.loginMethod))},dependencies:[g.O5,Z.Hw,C.lW,h.kc,f._Y,f.Fj,f.JJ,f.JL,f.sg,f.u,q.TO,q.KE,q.hX,si.Nt,L.N],styles:["h4[_ngcontent-%COMP%], p[_ngcontent-%COMP%]{margin-bottom:20px}h2[_ngcontent-%COMP%]{padding:20px}.action-panel[_ngcontent-%COMP%]{margin-top:20px}.action-panel[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:12px}.profile-container[_ngcontent-%COMP%]{padding:20px}.profile-image[_ngcontent-%COMP%]{padding:20px;width:100%;float:left;text-align:center}.profile-form[_ngcontent-%COMP%]{padding:20px;width:100%;float:left}@media (min-width: 600px){.profile-image[_ngcontent-%COMP%]{width:30%;float:left}.profile-form[_ngcontent-%COMP%]{width:70%;float:left}.profile-image-actions[_ngcontent-%COMP%]{text-align:left!important}}.avatar[_ngcontent-%COMP%]{width:160px;height:160px;border-radius:50%;flex-shrink:0;object-fit:cover;border:2px solid}.profile-form[_ngcontent-%COMP%]{padding:20px 40px}.profile-field[_ngcontent-%COMP%]{width:100%}.action-panel[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:10px}.subtitle[_ngcontent-%COMP%]{margin-bottom:20px}.addresses-container[_ngcontent-%COMP%]{margin-bottom:12px;font-size:12px}.main-address[_ngcontent-%COMP%]{justify-content:right}.profile-image-actions[_ngcontent-%COMP%]{text-align:center;width:72%;margin:20px auto 0}.profile-image-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:6px 3px}.instructions[_ngcontent-%COMP%]{font-size:13px}"]}),o})();function gi(o,a){if(1&o&&(t.TgZ(0,"p",5),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.data.msg," ")}}function ui(o,a){if(1&o&&(t.TgZ(0,"p",6)(1,"mat-checkbox",7),t._uU(2," Send tx for FREE (Dispatch method) "),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("formControl",e.useDispatch)}}function mi(o,a){if(1&o&&(t.TgZ(0,"mat-dialog-content",2)(1,"div"),t.YNc(2,gi,2,1,"p",3),t.YNc(3,ui,3,1,"p",4),t.qZA()()),2&o){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.data.msg),t.xp6(1),t.Q6J("ngIf",e.dispatchAvailable)}}function fi(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-dialog-actions",8)(1,"button",9),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.close(!1,!1))}),t._uU(2,"Close"),t.qZA(),t._UZ(3,"div",10),t.TgZ(4,"button",11),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.close(!0,n.useDispatch.value))}),t.TgZ(5,"span"),t._uU(6,"Yes, create tx!"),t.qZA()()()}}let hi=(()=>{class o{constructor(e,i,n,s){this._dialogRef=e,this.data=i,this._utils=n,this._arweave=s,this.useDispatch=new f.p4(!1),this.loadingConfirmation=!1,this.dispatchAvailable=!1}ngOnInit(){this.data.dataSize<=this._arweave.dataSizeLimitDispatch&&(this.dispatchAvailable=!0)}close(e=!1,i=!1){this._dialogRef.close({success:e,useDispatch:i})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(m.so),t.Y36(m.WI),t.Y36(x.F),t.Y36(b.N))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-confirmation-dispatch-dialog"]],decls:2,vars:2,consts:[["class","content border-right-special",4,"ngIf"],["align","start",4,"ngIf"],[1,"content","border-right-special"],["class","text-center",4,"ngIf"],["class","text-right",4,"ngIf"],[1,"text-center"],[1,"text-right"],[1,"dispatch-chk",3,"formControl"],["align","start"],["mat-button","","cdkFocusInitial","",3,"click"],[1,"spacer"],["mat-flat-button","","color","accent",3,"click"]],template:function(e,i){1&e&&(t.YNc(0,mi,4,2,"mat-dialog-content",0),t.YNc(1,fi,7,0,"mat-dialog-actions",1)),2&e&&(t.Q6J("ngIf",i.data.address),t.xp6(1),t.Q6J("ngIf",i.data.address))},dependencies:[g.O5,U.oG,f.JJ,f.oH,C.lW,m.xY,m.H8],styles:[".content[_ngcontent-%COMP%]{padding:10px;min-height:100px;max-width:680px;min-width:200px;margin:0 auto}.content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:6px}.title-text[_ngcontent-%COMP%]{font-weight:700}.mat-dialog-container[_ngcontent-%COMP%]{padding:0}@media (min-width: 420px){.content[_ngcontent-%COMP%]{min-width:400px}}@media (min-width: 820px){.content[_ngcontent-%COMP%]{min-width:680px}}.wallets[_ngcontent-%COMP%], .dispatch-chk[_ngcontent-%COMP%]{font-size:12px}.mat-spinner[_ngcontent-%COMP%]{display:inline;margin-left:12px}"]}),o})();function _i(o,a){1&o&&t._UZ(0,"mat-progress-bar",9)}const bi=function(o){return{"background-image":o}};function xi(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",1)(1,"h4"),t._uU(2,"Banner image"),t.qZA(),t.TgZ(3,"p"),t._uU(4,"The image at the top of your profile."),t.qZA(),t._UZ(5,"div",2),t.YNc(6,_i,1,0,"mat-progress-bar",3),t.TgZ(7,"p",4)(8,"button",5),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.uploadFile("image"))}),t.TgZ(9,"mat-icon",6),t._uU(10,"image"),t.qZA(),t._uU(11," Upload file"),t.qZA(),t.TgZ(12,"button",5),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.fileManager("image"))}),t.TgZ(13,"mat-icon"),t._uU(14,"perm_media"),t.qZA(),t._uU(15," File manager"),t.qZA(),t.TgZ(16,"button",7),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.removeBannerImage(!0))}),t.TgZ(17,"mat-icon"),t._uU(18,"delete"),t.qZA(),t._uU(19," Remove image"),t.qZA(),t.TgZ(20,"button",8),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.saveBannerImage())}),t.TgZ(21,"mat-icon"),t._uU(22,"save"),t.qZA(),t._uU(23," Save changes"),t.qZA()()()}if(2&o){const e=t.oxw();t.xp6(5),t.Q6J("ngStyle",t.VKq(6,bi,e.bannerImage?"url("+e.bannerImage+")":"")),t.xp6(1),t.Q6J("ngIf",e.loadingSavingNewBannerImage),t.xp6(2),t.Q6J("disabled",e.loadingSavingNewBannerImage),t.xp6(4),t.Q6J("disabled",e.loadingSavingNewBannerImage),t.xp6(4),t.Q6J("disabled",e.loadingSavingNewBannerImage),t.xp6(4),t.Q6J("disabled",!e.saveNewBannerImage||e.loadingSavingNewBannerImage)}}function wi(o,a){1&o&&(t.TgZ(0,"div",1),t._uU(1," Please login first.\n"),t.qZA())}function vi(o,a){1&o&&(t.TgZ(0,"div",1),t._uU(1," You don't have enough privileges for editing this profile.\n"),t.qZA())}const Ci=[{path:"",component:St,resolve:{profile:M},children:[{path:"replies",component:de},{path:"likes",component:he},{path:"pending",component:Pe},{path:"followers",component:Me},{path:"following",component:Ue},{path:"edit",component:di},{path:"edit-banner",component:(()=>{class o{constructor(e,i,n,s,l,r,c,d){this._userSettings=e,this._auth=i,this._dialog=n,this._arweave=s,this._appSettings=l,this._profile=r,this._utils=c,this._route=d,this.mainAddress="",this.bannerImage="",this.bannerTx="",this.saveNewBannerImage=!1,this.loadingSavingNewBannerImage=!1,this.subscriptionSavingNewBannerImage=u.w0.EMPTY,this._profileSubscription=u.w0.EMPTY,this.addressFromRoute="",this.profile=void 0}ngOnInit(){this._appSettings.scrollTo("ww-mat-sidenav-main-content",400),this.mainAddress=this._auth.getMainAddressSnapshot(),this._route.parent.data.subscribe(e=>{const i=e&&Object.prototype.hasOwnProperty.call(e,"profile")?e.profile:{},n=i&&i.hasOwnProperty("address")?i.address:"",s=i&&i.hasOwnProperty("profile")&&i.profile?i.profile:{};this.addressFromRoute=n,this.profile=s,this.loadBannerImage(this.mainAddress)}),this._auth.account$.subscribe(e=>{this.mainAddress=e,e?this.loadBannerImage(this.mainAddress):this.removeBannerImage(!1)})}fileManager(e){const i=this._userSettings.getDefaultLang(),n=this._userSettings.getLangObject(i);this._dialog.open(G,{restoreFocus:!1,autoFocus:!1,disableClose:!0,data:{type:e,address:this.mainAddress},direction:n&&"LTR"===n.writing_system?"ltr":"rtl",width:"800px"}).afterClosed().subscribe(r=>{if(r){const c={id:r.id,type:r.type,content:""};this.saveNewBannerImage=!0,this.bannerImage=this.getImageUrl(c.id),this.bannerTx=c.id}})}uploadFile(e){const i=this._userSettings.getDefaultLang(),n=this._userSettings.getLangObject(i);this._dialog.open(V,{restoreFocus:!1,autoFocus:!0,disableClose:!0,data:{type:e,address:this.mainAddress},direction:n&&"LTR"===n.writing_system?"ltr":"rtl",width:"800px"}).afterClosed().subscribe(r=>{if(r){const c={id:r.id,type:r.type,content:""};this.saveNewBannerImage=!0,this.bannerImage=this.getImageUrl(c.id),this.bannerTx=c.id}})}saveBannerImage(){const e=this._userSettings.getDefaultLang(),i=this._userSettings.getLangObject(e);let n=i&&"LTR"===i.writing_system?"ltr":"rtl";this.loadingSavingNewBannerImage=!1,this._dialog.open(hi,{restoreFocus:!1,autoFocus:!1,disableClose:!0,data:{address:this.mainAddress,msg:`Confirm new banner image? (A new tx is gonna be created). New image: ${this.bannerTx}`,dataSize:100},direction:n,width:"800px"}).afterClosed().subscribe(l=>{if(l.success){this.loadingSavingNewBannerImage=!0;try{this.subscriptionSavingNewBannerImage=this._profile.saveBannerImage(this.bannerTx,!l.useDispatch).subscribe({next:r=>{this._utils.message(`Success ${r.id}`,"success"),this.loadingSavingNewBannerImage=!1},error:r=>{this._utils.message("Error!","error"),this.loadingSavingNewBannerImage=!1,console.error(r)}})}catch(r){this._utils.message("Error!","error"),this.loadingSavingNewBannerImage=!1,console.error(r)}}})}getImageUrl(e){return this._arweave.getImageUrl(e)}removeBannerImage(e){this.bannerImage="",this.bannerTx="",this.saveNewBannerImage=e}ngOnDestroy(){this.subscriptionSavingNewBannerImage.unsubscribe()}loadBannerImage(e){this.removeBannerImage(!1),this._profileSubscription=this._arweave.getNetworkInfo().pipe((0,w.w)(n=>this._profile.getBannerImg(e,10,n.height))).subscribe({next:n=>{const s=n[0],r=this._utils.sanitizeFull(this.findTag(s&&s.tags?s.tags:[],"Img-Src-Id"));this.bannerImage="",this.bannerTx="",r&&this._arweave.validateAddress(r)&&(this.bannerImage=this.getImageUrl(r),this.bannerTx=r)},error:n=>{console.error("BannerImg",n)}})}findTag(e,i){for(const n of e)if(n.name===i)return n.value?n.value.trim():"";return""}isValidUser(){let e=!1;const i=this.profile&&this.profile.address?[this.profile.address]:[];return((this.addressFromRoute===(this.profile&&this.profile.username?this.profile.username:"")||i.findIndex(s=>s===this.addressFromRoute)>=0)&&i.findIndex(s=>s===this.mainAddress)>=0||this.addressFromRoute===this.mainAddress)&&(e=!0),e}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(A.s),t.Y36(F.H),t.Y36(m.uw),t.Y36(b.N),t.Y36(P.X),t.Y36(I.H),t.Y36(x.F),t.Y36(_.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-edit-profile-banner"]],decls:5,vars:3,consts:[["class","profile-container",4,"ngIf"],[1,"profile-container"],[1,"profile-header","mat-elevation-z2","pacific-dream",3,"ngStyle"],["class","progress-bar-header","color","accent","mode","indeterminate",4,"ngIf"],[1,"action-panel"],["mat-stroked-button","","color","accent","type","button",3,"disabled","click"],[1,"material-icons-outlined"],["mat-stroked-button","","color","warn","type","button",3,"disabled","click"],["mat-flat-button","","color","accent","type","button",3,"disabled","click"],["color","accent","mode","indeterminate",1,"progress-bar-header"]],template:function(e,i){1&e&&(t.TgZ(0,"h2"),t._uU(1,"Edit banner"),t.qZA(),t.YNc(2,xi,24,8,"div",0),t.YNc(3,wi,2,0,"div",0),t.YNc(4,vi,2,0,"div",0)),2&e&&(t.xp6(2),t.Q6J("ngIf",i.mainAddress&&i.isValidUser()),t.xp6(1),t.Q6J("ngIf",!i.mainAddress),t.xp6(1),t.Q6J("ngIf",!i.isValidUser()&&i.mainAddress))},dependencies:[g.O5,g.PC,R.pW,Z.Hw,C.lW],styles:["h4[_ngcontent-%COMP%], p[_ngcontent-%COMP%]{margin-bottom:20px}h2[_ngcontent-%COMP%]{padding:20px}.profile-header[_ngcontent-%COMP%]{height:180px;background-image:none;background-position:center!important;background-repeat:no-repeat!important;background-size:cover!important}.profile-header.pacific-dream[_ngcontent-%COMP%]{background:#34e89e;background:linear-gradient(to right,#0f3443,#34e89e)}.action-panel[_ngcontent-%COMP%]{margin-top:20px}.action-panel[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:12px}.profile-container[_ngcontent-%COMP%]{padding:20px}"]}),o})()},{path:":storyId",component:Kt},{path:"",component:ae,pathMatch:"full"}]}];let Pi=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[_.Bz.forChild(Ci),_.Bz]}),o})();var Ti=p(4466);let Zi=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[g.ez,Pi,Ti.m]}),o})()}}]);